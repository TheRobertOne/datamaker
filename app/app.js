!function(i){function t(){var n,d=this,o={},r=0,l=1,g=2,h=!1;this.log=function(t){document.getElementById("wcr_log")||((e=document.createElement("div")).id="wcr_log",document.body.appendChild(e));var e,a=document.createElement("p");a.innerHTML=t,(e=document.getElementById("wcr_log")).insertBefore(a,e.firstChild)},this.setup=function(t,i){if(this.detactSDKType(),this.sdk_type_!=r){if(this.sdk_type_==g){var e=JSON.parse(window.WCRDocJSSDK.getUser());1==e.isTeacher?o.isTeacher=!0:o.isTeacher=!1,o.classId=e.classId,o.userId=e.userId,o.token=e.token,o.version=e.version,window.WCRDocJSSDK.setMsgCallback(this.persistentCallback(this.onMessageReceived)),n=t.msg_callback,d.doc_id_=window.WCRDocJSSDK.getDocId(),h=!0;var a={classId:e.classId,userId:e.userId,token:e.token,version:e.version};i(0,a)}else if(this.sdk_type_==l){var s={message:"setup",body:{msg_callback:this.persistentCallback(this.onMessageReceived)},callback:this.oneshotCallback(function(t){var e=t.error;if(e)i(e,t.description);else{o.isTeacher=t.isTeacher,o.classId=t.classId,o.userId=t.userId,o.token=t.token,o.version=t.version,d.doc_id_=t.docId,h=!0;var a={classId:t.classId,userId:t.userId,token:t.token,version:t.version};i(0,a)}})};n=t.msg_callback,window.webkit.messageHandlers.WCRDocJSSDK.postMessage(JSON.stringify(s))}}else i(-1,"unknown client")},this.oneshotCallback=function(e){var a="ONESHOT_"+(new Date).getTime()+"_";return i[a]=function(t){e(t),delete i[a]},a},this.persistentCallback=function(e){var t="PERSISTENT_"+(new Date).getTime()+"_";return i[t]=function(t){e(t)},t},this.detactSDKType=function(){null!=window.webkit&&null!=window.webkit.messageHandlers&&null!=window.webkit.messageHandlers.WCRDocJSSDK?this.sdk_type_=l:window.WCRDocJSSDK?this.sdk_type_=g:this.sdk_type_=r},this.getDocId=function(){return this.doc_id_},this.isTeacher=function(){return o.isTeacher},this.getUserId=function(){return o.userId},this.getClassId=function(){return o.classId},this.sendStartTesting=function(t,e,a,i){if(!this.isTeacher())return d.log("! student permission denied"),!1;var s={docid:t,tid:e,starttime:a,timeout:i};this.sendMessage("start.test",s)},this.requestStudentsList=function(t){if(!this.isTeacher()){var e={docid:t};this.sendMessage("requestStudentsList",e)}},this.sendStopTesting=function(t,e){if(!this.isTeacher())return d.log("! student permission denied"),!1;var a={docid:t,tid:e};this.sendMessage("stop.test",a)},this.sendTestingScore=function(t,e,a,i,s){if(this.isTeacher())return d.log("! teacher permission denied"),!1;s||(s=0);var n={docid:t,tid:e,score:a,maxscore:i,animation:s};this.sendMessage("report.test.score",n)},this.sendMessage=function(t,e){if(h)if(d.log("Message->: "+t),this.sdk_type_==l){var a={message:"sendMessage",body:{msg:t,body:e},callback:this.oneshotCallback(function(t){})};window.webkit.messageHandlers.WCRDocJSSDK.postMessage(JSON.stringify(a))}else window.WCRDocJSSDK.sendMessage(t,JSON.stringify(e))},this.startSpeechEvaluation=function(t,e,a,i,s,n){if(h)if(s)if("zh_cn"==e||"en_us"==e){var o={timeout:i,type:t,language:e,data:a,tid:n};if(this.sdk_type_==l){var r={message:"startSpeechEvaluation",body:o,callback:this.persistentCallback(function(t){s(t)})};window.webkit.messageHandlers.WCRDocJSSDK.postMessage(JSON.stringify(r))}else window.WCRDocJSSDK.startSpeechEvaluation(JSON.stringify(o),this.persistentCallback(function(t){s(t)}))}else d.log("! startSpeechEvaluation failed - language is invalid");else d.log("! startSpeechEvaluation failed - callback is null");else d.log("! startSpeechEvaluation failed - init not complete")},this.duringSpeechEvaluation=function(e){var t={};if(this.sdk_type_==l){var a={message:"duringSpeechEvaluation",body:t,callback:this.oneshotCallback(function(t){e(t)})};window.webkit.messageHandlers.WCRDocJSSDK.postMessage(JSON.stringify(a))}else window.WCRDocJSSDK.duringSpeechEvaluation(JSON.stringify(t),this.oneshotCallback(function(t){e(t)}))},this.stopSpeechEvaluation=function(){if(d.log("stopSpeechEvaluation"),this.sdk_type_==l){var t={message:"stopSpeechEvaluation",body:{}};window.webkit.messageHandlers.WCRDocJSSDK.postMessage(JSON.stringify(t))}else window.WCRDocJSSDK.stopSpeechEvaluation()},this.getFinalScore=function(e){if(d.log("getFinalScore"),this.sdk_type_==l){var t={message:"getFinalScore",body:{},callback:this.oneshotCallback(function(t){e(t)})};window.webkit.messageHandlers.WCRDocJSSDK.postMessage(JSON.stringify(t))}else window.WCRDocJSSDK.getFinalScore(this.oneshotCallback(function(t){e(t)}))},this.onMessageReceived=function(t){d.log("Message<-: "+t.msg),n&&n(t)}}var e=new t;i.WCRDocSDK=e,i.WCRInteractiveDocSDK=t}(window);var xmlHttp,IBL_KOREA="//socket.firstleap.cn",IBL_TEST="//socket-test.firstleap.cn",IBL_TEST1="//tv-socket-dev.firstleap.cn",API_IBL_BASIC=IBL_KOREA+"/webapi/v4/",KOREA="//v4.firstleap.cn/",KOREA_TEST="//devv4.firstleap.cn",TV_KOREA="//realtime-tv.abctime.com/webapi/v4/",API_IBL_COURSEWARE="https://realtime-tv.abctime.com/webapi/v4/ibl/lesson/courseware",API_IBL_VOTE=TV_KOREA+"vote",API_IBL_GET_VOTE=TV_KOREA+"vote/data",API_IBL_ADD_RECORD=API_IBL_BASIC+"lesson/record/add",API_IBL_GET_RECORD=API_IBL_BASIC+"lesson/record",API_IBL_WIN_RECORD=API_IBL_BASIC+"win.record/add",test_api="//socket.firstleap.cn/webapi/v4/",API_IBL_GROUP=test_api+"lesson/group/users";function createxmlHttpRequest(){window.ActiveXObject?xmlHttp=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(xmlHttp=new XMLHttpRequest)}function doGet(t,e){createxmlHttpRequest(),xmlHttp.open("GET",t),xmlHttp.send(null),xmlHttp.onreadystatechange=function(){4==xmlHttp.readyState&&200==xmlHttp.status&&(console.log("请求成功",xmlHttp.responseText),e(JSON.parse(xmlHttp.responseText)))}}function doPost(t,e,s){var n=new XMLHttpRequest;n.open("POST",t,!0),n.timeout="30000",n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){var t=n;if(console.log(t.readyState),4==t.readyState)if(console.log(t.status),200==t.status){var e=t.responseText;s(JSON.parse(e))}else{if(console.log(t.status),s(!1),gameManager)var a={status:t.status,timeout:t.timeout,sid:gameManager.sid,tid:gameManager.tid,lessonID:gameManager.lesson_id};else a={status:t.status,timeout:t.timeout};var i=JSON.stringify(a);aliyun_log("err_request",i)}},n.send(dataser(e))}function dataser(t){var e="";for(var a in t)e+=a+"="+t[a]+"&";return e}!function(a){window.conn,a.gameManager=new function(){this.record_current_tid=0,this.msg="",this.msgBody="",this.uid=0,this.sid=0,this.lesson_id=0,this.api=null,this.game=null,this.is_teacher=null,this.version=null,this.versionType=!1,this.is_version=null,this.lesson_token=null,this.debug=!1;var v=this;this.recorder={scores:0,volume:0},this.recorder_call=null;var s=[];this.gulp_list=[],this.slider=new Object,null!=json_data&&(this.pageCount=json_data.courseware.length),this.start=0,this.starsNum=0;var f=null;function o(t){for(var e=(t=t.toString()).split("."),a=["","0","00","000","0000"].reverse(),i=0;i<e.length;i++){var s=e[i].length;e[i]=a[s]+e[i]}return e.join("")}function i(i){var t={lesson_id:v.lesson_id,page:v.tid,sid:v.sid,stars:v.start,scores:i};console.log("record",t),doPost(API_IBL_ADD_RECORD,t,function(t){var e,a;t||(e=i,a={lesson_id:v.lesson_id,page:v.tid,sid:v.sid,stars:v.start,scores:e},console.log("record",a),doPost(API_IBL_ADD_RECORD,a,function(t){1001==t.status&&n(e)})),1001==t.status&&n(i)})}function n(t){var e=0;s[v.tid]=v.start,log("存储星星==="+s),log("获得星星数==1="+s[v.tid]);for(var a=0;a<s.length;a++)s[a]&&(log("获得星星数=2=="+s[a]),e+=s[a]);log("获得星星数=3=="+e),v.starsNum=e,game.startCont.text=e,aliyun_log("debug_after_request",v.sid+":page:"+v.tid+"star:"+t);var i=game.add.image(825,5,"startLvie");i.animations.add("run"),i.animations.play("run",24,1,1),game.btn=!1,game.sound.play("StarAddeds",.1)}this.init=function(t,e){a.conn;try{"1"==window.location.href.split("?")[1].split("=")[1]&&(v.debug=!1)}catch(t){}v.api=t,v.game=e,v.log("初始化api,执行api setup方法"),v.api.setup({msg_callback:v.callback},v.api_complete)},this.onerror=function(){},this.log=function(t){if(v.debug){document.getElementById("sdk_log")||((e=document.createElement("div")).id="sdk_log",document.body.appendChild(e));var e,a=document.createElement("p"),i=typeof t;a.innerHTML="string"==typeof t?i+t:i+JSON.stringify(t),(e=document.getElementById("sdk_log")).insertBefore(a,e.firstChild)}},this.api_complete=function(t,e){var a,i,s,n;v.log("api设置成功回调,开始初始化游戏"),t?v.log("接口初始化错误:"+t):(v.log("接收到接口数据"),v.log(e),v.lesson_id=e.classId,v.lesson_token=e.token,v.lesson_token?v.courseIntroduction(json_data.courseware):v.log("token===",v.lesson_token),v.is_teacher=v.api.isTeacher(),v.is_teacher?(v.uid=e.userId,v.renderStartGameBtn()):v.sid=e.userId,v.version=e.version,v.version&&(a="1.1.2",i=v.version,s=o(a),n=o(i),s==n&&(console.log("版本号相同！版本号为："+a),v.is_version=a,v.versionType=!0),n<s&&(console.log("版本号"+a+"是新版本！"),v.versionType=!1),s<n&&(v.versionType=!0,console.log("版本号"+i+"是新版本！"),v.is_version=i)),v.docid=v.api.getDocId(),v.tid=0,v.game.init_game(v.docid,v.tid,v.is_teacher),v.is_teacher||v.showWait())},this.renderStartGameBtn=function(){},this.callback=function(t){v.log(JSON.stringify(t));var e=t.msg,a=t.body;switch(v.log("收到消息,body____"),v.log(a),v.msg=e,v.msgBody=a,v.msg){case"start.test":v.log("学生收到消息,开始答题"),console.log(v.msg),v._studentStartTesting();case"post.vote":v.log("老师收到投票消息")}},this.courseIntroduction=function(t){if(v.is_teacher){for(var e=new Array,a=0;a<t.length;a++){var i={page:t[a].page,type:t[a].type,content_type:t[a].content_type,content:t[a].content};e.push(i)}var s={title:json_data.lesson_title,points:json_data.lesson_points,pages:e},n={lesson_id:v.lesson_id,data:JSON.stringify(s)};null==v.lesson_id&&(s.lesson_id=0),console.log("上传数据====",n),doPost(API_IBL_COURSEWARE,n,function(t){console.log("收到服务器返回结果===",t)})}},this.requestStudentsList=function(){this.is_teacher||v.api.requestStudentsList(v.docid)},this._studentStartTesting=function(){!v.is_teacher||v.debug?(v.log("执行开始测试事件"+v.msgBody),v.log(v.msgBody),v.game.start_game()):console.log("教师端,取消执行")},this._studentStopTesting=function(){!v.is_teacher||v.debug?(v.log("执行开始测试事件"+v.msgBody),v.log(v.msgBody),console.log("老师发",v.msgBody),v.game.stop_game(v.msgBody)):console.log("教师端,取消执行")},this.sendScore=function(t,e,a){if(!v.is_teacher||v.debug){v.stars(t),v.log("学生添加分数,页码"+v.tid);var i=(n=new Date,o=n.getMonth()+1,r=n.getDate(),1<=o&&o<=9&&(o="0"+o),0<=r&&r<=9&&(r="0"+r),n.getFullYear()+"-"+o+"-"+r+" "+n.getHours()+":"+n.getMinutes()+":"+n.getSeconds()),s=0;t<=59&&0<t?s=1:60<=t&&t<=79?s=2:79<t&&(s=3),v.log("提交分数"+t),v.log("提交星星数"+s),v.log("提交分数时间====="+i),v.log("执行动画"+a),v.api.sendTestingScore(v.docid,v.tid,s,e,a),v.log("分数已发送到api接口"+t)}var n,o,r},this.stars=function(t){v.is_teacher&&!v.debug||(t<=59&&0<t?v.start=1:60<=t&&t<=79?v.start=2:79<t&&(v.start=3))},this.startTesting=function(){setTimeout(function(){var t=(new Date).getTime(),e=9,i=json_data.courseware[v.tid];""==i.type&&(e=11),v.log("老师发布开始答题,当前页码"+v.tid),v.log("添加定时器执行停止答题事件"),v.timer=setTimeout(function(){if(v.log("老师发布停止答题,当前页码"+v.tid),console.log("老师发布停止答题,当前页码"+v.tid),v.api.sendStopTesting(v.docid,v.tid),i&&"survey"==i.type){v.log("老师收到投票消息2======");for(var t=i.data.body,e=new Array,a=0;a<t.length;a++)e.push(t[a].name);v.getVote(e)}},1e3*e),v.api.sendStartTesting(v.docid,v.tid,t,e)},2500)},this.getVote=function(t){var e=t.join(",");if(e){v.log("获取投票结果======"+e),v.log("获取投票结果======"+v.lesson_id+"页码"+v.tid);var a=v.lesson_id,i=v.tid;doGet(API_IBL_GET_VOTE+"?lesson_id="+a+"&page="+i+"&items="+e,function(t){1001==t.status&&(log("获取成功请求"),log(t.data),v.game.state.getCurrentState().getItemVote(t.data))})}},this.postVote=function(t){if(t){v.log("学生发送投票======"+t),console.log("发送投票",t,v.lesson_id,v.tid);var e={lesson_id:v.lesson_id,page:v.tid,item:t};doPost(API_IBL_VOTE,e,function(t){})}},this.addRecord=function(e){if(console.log("当前题星星数===",v.start,v.tid),v.versionType)v.sendScore(e,100,-1);else if(aliyun_log("debug_before_request",v.sid+":page:"+v.tid+"star:"+e),v.sendScore(e,100,-1),e||0==e){var a={lesson_id:v.lesson_id,page:v.tid,sid:v.sid,stars:v.start,scores:e};console.log("record",a),doPost(API_IBL_ADD_RECORD,a,function(t){log(a),t||i(e),1001==t.status&&n(e)})}else console.log("分数提交错误==",e)},this.getRecord=function(){if(0<s.length)console.log("获取线上记录数据=====",s);else{var t=v.lesson_id,e=v.sid,a=0;doGet(API_IBL_GET_RECORD+"?lesson_id="+t+"&sid="+e+"&page="+v.tid,function(t){if(1001==t.status){if(0<t.data.length){for(var e=0;e<t.data.length;e++)s[t.data[e].page]=t.data[e].stars,a+=t.data[e].stars;game.startCont&&(game.startCont.text="",v.starsNum=a,game.startCont.text=a,log("线上拉取星星数"),log(a))}v.log("请求的数据===线上数据=="+t.data),v.log("学生ID==="+v.sid+"班级id===="+v.lesson_id)}})}},this.setTid=function(t){v.tid>=v.pageCount?v.is_teacher||v.showWait():(v.log("当前页面编号"+t),v.tid=t,v.game.gotoStage(v.tid))},this.nextPage=function(){clearTimeout(v.timer),v.tid++,v.setTid(v.tid)},this.perPage=function(){clearTimeout(v.timer),0!=v.tid&&(v.tid--,v.setTid(v.tid))},this.recordword=function(t,e){var a={words:t};v.recorder_call=e,v._record("read_word",a)},this.recordsentence=function(t,e){var a=t.split(" ");if(a.length<=5)v.recordword(a,e);else{var i={sentence:t};v.recorder_call=e,v._record("read_sentence",i)}},this._record=function(t,e){v.record_current_tid=v.tid,v.log("录音传入时间========6"),v.api.startSpeechEvaluation(t,"en_us",e,6,v._record_call,v.tid.toString())},this.stopRecord=function(){v.api.stopSpeechEvaluation()},this.isRecording=function(){return v.api.recording()},this._record_call=function(t){if(v.record_current_tid==v.tid){var e=t.notify;if("onVolumeChanged"==e){var a=t.body.volume;v.recorder.volume=a,v.log("收到音量回调消息",a),v.recorder_call("volume",a)}else if("onResults"==e){v.log("收到录音分数消息"),v.recorder.volume=0;var i=t.body.score;v.recorder.scores=i,v.log("分数为"+i),v.recorder_call("scores",i)}else if("onBeginOfSpeech"==e)v.log("onBeginofSpeech事件");else if("onCancel"==e)v.log("录音取消回调数据"),v.recorder.volume=0,v.recorder.scores=.5*Math.random()+1,v.recorder.scores<1&&(v.recorder.scores=.5*Math.random()+20),v.recorder_call("scores",v.recorder.scores);else if("onError"==e){if(v.log("录音出错回调数据"),!t.err)return void v.log("虽然回调，但错误码为0，取消",v.recorder.scores);v.recorder.volume=0,v.recorder.scores=.5*Math.random()+1,v.recorder.scores<1&&(v.recorder.scores=.5*Math.random()+20),v.recorder_call("scores",v.recorder.scores)}else v.log(t),v.log("未定义的事件")}else v.log("录音页面"+v.record_current_tid+",当前页面"+v.tid+",取消回调")},v.slider.currentSlideIndex=function(){return v.tid},v.slider.startAnswer=function(){v.game.answers_start()},v.slider.updateStarCount=function(t){if(v.versionType&&!v.is_teacher)if(log("星星数"+t),game&&game.startCont){if(parseInt(t)>parseInt(game.startCont.text)){log("调用直播云星星数赋值");var e=t.toString();v.starsNum=e,game.startCont.text=e,aliyun_log("debug_after_request",v.sid+":page:"+v.tid+"star:"+e);var a=game.add.image(825,5,"startLvie");a.animations.add("run"),a.animations.play("run",24,1,1),game.btn=!1,game.sound.play("StarAddeds")}}else log("星星数赋值变量"+t),game.startCont||(e=t.toString(),v.starsNum=e)},v.slider.updateStudentsList=function(t){if(!v.is_teacher&&t){var e=t,n=(t.groupid,e.data),o=[],r=[],d=document.getElementById("gulp_view"),l=document.getElementById("gulp_container"),a={uid:v.sid,gulp:n};if(aliyun_log("live_gulps",JSON.stringify(a)),is_gulp=!0,d.setAttribute("style","display:block;"),0<v.gulp_list.length){_(),console.log("res==777==",v.gulp_list);for(var i=0;i<n.length;i++)""==n[i].name&&u(n[i].uid,i);console.log("res==888==",n),d.setAttribute("style","display:block;"),o=[],r=[];for(var s=0;s<n.length;s++)n[s].uid==v.sid?(console.log("wossss",v.sid),l.appendChild(m(0,n[s]))):n[s].online&&1==n[s].online?r.push(n[s]):o.push(n[s]);return void c()}var g="";if(n){console.log("zj====",v.sid),o=[],r=[];for(var h=0;h<n.length;h++)""==n[h].name&&(g+=n[h].uid+","),n[h].name&&(n[h].uid==v.sid?l.appendChild(m(0,n[h])):n[h].online&&1==n[h].online?r.push(n[h]):o.push(n[h]));c()}function u(t,e){console.log("res==444==",e,v.gulp_list);for(var a=0;a<v.gulp_list.length;a++)v.gulp_list[a].uid==parseInt(t)&&(console.log("res==555=="),n[e].name=v.gulp_list[a].name,n[e].avatar=v.gulp_list[a].avatar)}function c(){for(var t=0;t<r.length;t++)l.appendChild(p(0,r[t]));for(var e=0;e<o.length;e++)l.appendChild(f(0,o[e]))}function m(t,e){e.avatar||(e.avatar="//tv.firstleap.cn/tv/placeholder_monkey_round.png");var a=document.createElement("li");return a.innerHTML='<p class="gulp_avator"> <span class="actor_me">我</span> <img src="'+e.avatar+'"> </p><p class="gulp_en_name">'+e.name+"</p>",a}function p(t,e){e.avatar||(e.avatar="//tv.firstleap.cn/tv/placeholder_monkey_round.png");var a=document.createElement("li");return a.innerHTML='<p class="gulp_avator"> <img src="'+e.avatar+'"> </p><p class="gulp_en_name">'+e.name+"</p>",a}function f(t,e){e.avatar||(e.avatar="//tv.firstleap.cn/tv/placeholder_monkey_round.png");var a=document.createElement("li");return a.innerHTML='<p class="gulp_avator gray"> <img src="'+e.avatar+'"> </p><p class="gulp_en_name gray_name">'+e.name+"</p>",a}function _(){d.setAttribute("style","display:none;");for(var t=l.getElementsByTagName("li"),e=0;e<t.length;e++)l.removeChild(l.getElementsByTagName("li")[e]),e--}""!=g&&doGet(API_IBL_GROUP+"?sids="+g,function(t){if(1001==t.status){console.log("res====",t);for(var e=0;e<t.data.length;e++){var a={};a.name=t.data[e][2],a.uid=t.data[e][0],a.avatar=t.data[e][1],v.gulp_list.push(a)}_(),console.log("res==222==",v.gulp_list);for(var i=0;i<n.length;i++)""==n[i].name&&u(n[i].uid,i);console.log("res==333==",n),d.setAttribute("style","display:block;"),o=[],r=[],console.log("zj====",v.sid);for(var s=0;s<n.length;s++)n[s].uid==v.sid?l.appendChild(m(0,n[s])):n[s].online&&1==n[s].online?r.push(n[s]):o.push(n[s]);c()}})}},v.slider.currentSlideStep=function(){return 0},v.slider.slidesCount=function(){return v.pageCount},v.slider.stepCount=function(t){return 1},v.slider.gotoNextStep=function(){v.nextPage()},v.slider.gotoNextSlide=function(){v.nextPage()},v.slider.gotoLastSlide=function(){clearTimeout(v.timer),v.setTid(v.pageCount-1)},v.slider.gotoPreviousStep=function(){v.perPage()},v.slider.gotoPreviousSlide=function(){v.perPage()},v.slider.gotoFirstSlide=function(){clearTimeout(v.timer),v.setTid(0)},v.slider.gotoSlideStep=function(t,e){clearTimeout(v.timer),v.setTid(t)},this.doFinalScore=function(){},this.finalscoreCall=function(t){},this.renderScoreRank=function(t){document.getElementById("rank_view").setAttribute("style","display:block;");var e=document.getElementById("class_rank"),a=document.getElementById("student_rank"),i=t.group,s={};s.id=v.sid;var n,o,r=t.groups,d=t.students;if(r.sort(function(t,e){return e.totalScore-t.totalScore}),d.sort(function(t,e){return e.totalScore-t.totalScore}),!v.is_teacher){for(var l in r)if(i){if(!i.id)return;i.id==r[l].id&&(f=l)}for(var g in d)s.id==d[g].id&&(console.log("个人名次===2==",s.id),s.withinGroupRank=d[g].withinGroupRank,s.name=d[g].name,s.avatar=d[g].avatar,s.id=d[g].id,s.totalScore=d[g].totalScore);e.appendChild(function(t){""!=t.avatar&&null!=t.avatar||(t.avatar="//tv.firstleap.cn/tv/placeholder_monkey_round.png");var e=document.createElement("li");return e.innerHTML='<span class="class_order"></span><p class="p1"><img src="'+t.avatar+'"><span class="me">我</span></p><p class="p2">'+t.name+'<br/><span class="ord_name">第'+s.withinGroupRank+'名</span></p><img src="./image/img/mission_star_unfinished.png" class="star_img"><a class="aa">'+t.totalScore+"</a>",e}(s)),null!=f&&a.appendChild((n=i,o=document.createElement("li"),n&&(n.avatar=n.avatar?n.avatar:"//tv.firstleap.cn/tv/placeholder_monkey_round.png",o.innerHTML='<span class="class_group"></span><p class="p1"></p><p class="p2">'+n.name+'<br/><span class="ord_name">我所在的小组</span></p><span class="class_order">'+Number(Number(f)+1)+"</span>"),o))}log("最终收到的排行榜==组内数据=="+s),log("最终收到的排行榜==小组组数据=="+i);for(var h=0;h<r.length;h++){var u=r[h];a.appendChild(p(h,u))}for(var c=0;c<d.length;c++)u=d[c],e.appendChild(m(c,u));function m(t,e){""!=e.avatar&&null!=e.avatar||(e.avatar="//tv.firstleap.cn/tv/placeholder_monkey_round.png");var a=document.createElement("li");switch(t){case 0:return v.log("第一名===组内==="),a.innerHTML='<span class="class_order"><img class="order" src="./image/img/bookroom_btn_runking_first.png"/></span><p class="p1"><img src="'+e.avatar+'"></p><p class="p2">'+e.name+'</p><img src="./image/img/mission_star_unfinished.png" class="star_img"><a class="aa">'+d[t].totalScore+"</a>",a;case 1:return v.log("第2名===组内==="),a.innerHTML='<span class="class_order"><img class="order" src="./image/img/bookroom_btn_runking_second.png"/></span><p class="p1"><img src="'+e.avatar+'"></p><p class="p2">'+e.name+'</p><img src="./image/img/mission_star_unfinished.png" class="star_img"><a class="aa">'+d[t].totalScore+"</a>",a;case 2:return v.log("第3名===组内==="),a.innerHTML='<span class="class_order"><img class="order" src="./image/img/bookroom_btn_runking_third.png"/></span><p class="p1"><img src="'+e.avatar+'"></p><p class="p2">'+e.name+'</p><img src="./image/img/mission_star_unfinished.png" class="star_img"><a class="aa">'+d[t].totalScore+"</a>",a;default:return a.innerHTML='<span class="class_order">'+Number(t+1)+'</span><p class="p1"><img src="'+e.avatar+'"></p><p class="p2">'+e.name+'</p><img src="./image/img/mission_star_unfinished.png" class="star_img"><a class="aa">'+d[t].totalScore+"</a>",a}}function p(t,e){""!=e.avatar&&null!=e.avatar||(e.avatar="//tv.firstleap.cn/tv/placeholder_monkey_round.png");var a=document.createElement("li");switch(t){case 0:return v.log("第一名====小组=="),a.innerHTML='<span class="class_group"><img class="order1" src="./image/img/group.png"/></span><p class="p2">'+e.name+'</p><span class="class_order"><img class="order" src="./image/img/bookroom_btn_runking_first.png"/></span>',a;case 1:return v.log("第2名====小组=="),a.innerHTML='<span class="class_group"><img class="order1" src="./image/img/group.png"/></span><p class="p2">'+e.name+'</p><span class="class_order"><img class="order" src="./image/img/bookroom_btn_runking_second.png"/></span>',a;case 2:return v.log("第3名====小组=="),a.innerHTML='<span class="class_group"><img class="order1" src="./image/img/group.png"/></span><p class="p2">'+e.name+'</p><span class="class_order"><img class="order" src="./image/img/bookroom_btn_runking_third.png" /></span>',a;default:return v.log("第4名====小组=="),a.innerHTML='<span class="class_group"><img class="order1" src="./image/img/group.png"/></span><p class="p2">'+e.name+'</p><span class="class_order">'+Number(Number(t)+1)+"</span>",a}}},v.showWait=function(){}},a.slideAPI=a.gameManager.slider,a.g=a.gameManager.slider.gotoSlideStep,a.gn=a.gameManager.nextPage}(window);var gameAdmissionAnimations,gameDisplayAnimations,gameErrorAnimations,gameLoadingAnimation,game=new Phaser.Game(1280,720,Phaser.CANVAS,"direct");game.loaded=!1,game.transparent=!0,game.state.add("boot",function(){this.init=function(){game.scale.pageAlignHorizontally=!0,game.scale.pageAlignVertically=!0,game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL},this.preload=function(){game.load.image("loading1","./image/game/loading_img01.png"),game.load.image("loading4","./image/game/loading_img04.png"),game.load.image("loading2","./image/game/loading_img02.png"),game.load.image("loading3","./image/game/loading_img03.png"),game.load.spritesheet("luyin","./image/game/yinliang.png",250,250,7),game.load.spritesheet("startLvie","./image/game/web_heart_animation-stars.png",100,100,29),game.load.image("luyinz","./image/game/luyinz.png"),game.load.image("go","./image/game/go.png"),game.load.spritesheet("tv_btn_team","./image/game/tv_btn_team.png",116,124,2),game.load.image("start","./image/game/start.png"),game.load.image("startNum","./image/game/startnum.png"),game.load.image("pre","./image/game/pre.png"),game.load.image("next","./image/game/next.png"),game.load.audio("wrong","./audio/Sound_Wrong2.wav"),game.load.spritesheet("wrongImage","./image/game/wrong.png",300,300,19),game.load.spritesheet("choice","./image/game/spritesheet.png",43.3,40,3),game.load.spritesheet("OK","./image/game/queren@2x.png",200,96,2),game.load.audio("startAdded","./audio/Sound_Amazing.m4a"),game.load.audio("fantastic","./audio/Sound_Fantastic.m4a"),game.load.audio("Sound_Super","./audio/Sound_Super.m4a"),game.load.audio("Sound_Awesome","./audio/Sound_Awesome.m4a"),game.load.audio("Sound_Great","./audio/Sound_Great.m4a"),game.load.audio("Sound_Wonderful","./audio/Sound_Wonderful.m4a"),game.load.audio("Sound_Wow_stupendous","./audio/Sound_Wow_stupendous.m4a"),game.load.audio("startCollected","./audio/Star_Collected.m4a"),game.load.audio("StarAddeds","./audio/StarAdded.m4a"),game.load.spritesheet("balls","./image/game/css_star.png",30,30,5),game.load.image("ant","./image/game/ant_03.png"),game.load.audio("goodplay","./audio/pla.mp3"),game.load.audio("errolplay","./audio/error.mp3")},this.create=function(){game.stage.disableVisibilityChange=!0,game.state.start("pre_loading")}}),game.show_mengban=function(t,e){if(t)game.mengban.x=-1024,game.mengban.destroy();else{var a=game.add.graphics(0,0);a.beginFill(16777200),a.drawRect(0,0,game.world.width,game.world.height),game.mengban=game.add.image(0,0,a.generateTexture()),game.mengban.alpha=0,game.mengban.inputEnabled=!0,a.destroy(),game.mengban.x=0}},game.init_game=function(t,e,a){console.log("游戏","初始化传入docid,tid,is_teacher"),game.docid=t,game.tid=e,game.is_teacher=a,game.state.start("boot")},game.gotoStage=function(t){game.loaded?(game.stateIndex=t,game.state.start("statemanager",!0,!1)):game.willGo=t},game.start_game=function(t){console.log("学生开始答题"),game.state.getCurrentState().startgame()},game.stop_game=function(t){console.log("结束答题===",t),game.state.getCurrentState().stopgame(t)},game.answers_start=function(){game.state.getCurrentState().answers_startgame()},game.state.add("pre_loading",function(){var o=this;this.init=function(){json_data&&(o.data=json_data.courseware)},this.preload=function(){var e=document.getElementById("progress");game.load.onFileComplete.add(function(t){e.innerText=t+"%",100==t&&(gameManager.is_teacher&&gameManager.courseIntroduction(o.data),gameManager.is_teacher||gameManager.versionType||gameManager.getRecord(),e.innerText="100%",show_reload(!1))}),game.pageCount=o.data.length,gameManager.pageCount=game.pageCount,console.log("预加载...",o.data);for(var t=0;t<o.data.length;t++){var a=o.data[t];switch(a.type){case"display":if(""!=a.data.overviewImage&&null!=a.data.overviewImage&&game.load.image(t+"overviewImage",a.data.overviewImage),a.data.body)for(var i=0;i<a.data.body.length;i++)""!=a.data.body[i].image&&null!=a.data.body[i].image&&game.load.image(t+"displayImage"+i,a.data.body[i].image);break;case"read":if(n=a.data.other_images)for(i=0;i<n.length;i++)game.load.image(t+"other_images"+i+"temp",n[i].image);""!=a.data.image&&null!=a.data.image&&game.load.image(t+"pic",a.data.image),""!=a.data.text_Image&&null!=a.data.text_Image&&game.load.image(t+"text_Image",a.data.text_Image),""!=a.data.overviewImage&&null!=a.data.overviewImage&&game.load.image(t+"overviewImage",a.data.overviewImage);break;case"choice":if(n=a.data.other_images)for(i=0;i<n.length;i++)game.load.image(t+"other_images"+i+"temp",n[i].image);""!=a.data.background&&game.load.image(t+"background",a.data.background),""!=a.data.titleImage&&null!=a.data.titleImage&&game.load.image(t+"titleImage",a.data.titleImage),""!=a.data.q_image&&null!=a.data.q_image&&game.load.image(t+"q_image",a.data.q_image);for(i=0;i<a.data.body.length;i++)game.load.image(t+"body_image"+i,a.data.body[i].image);break;case"multiselect":if(n=a.data.other_images)for(i=0;i<n.length;i++)game.load.image(t+"other_images"+i+"temp",n[i].image);""!=a.data.background&&game.load.image(t+"background",a.data.background);for(i=0;i<a.data.body.length;i++)game.load.image(t+"body_image"+i,a.data.body[i].image);""!=a.data.q_image&&null!=a.data.q_image&&game.load.image(t+"questionImage",a.data.q_image),""!=a.data.image&&null!=a.data.image&&game.load.image(t+"titleImage",a.data.image);break;case 5:for(i=0;i<a.data.groupA.length;i++)game.load.image(t+"groupA_image"+i,a.data.groupA[i].image);for(var s=0;s<a.data.groupB.length;s++)game.load.image(t+"groupB_image"+s,a.data.groupB[s].image);break;case"survey":if(n=a.data.other_images)for(i=0;i<n.length;i++)game.load.image(t+"other_images"+i+"temp",n[i].image);""!=a.data.overviewImage&&game.load.image(t+"overviewImage",a.data.overviewImage),""!=a.data.titleImage&&null!=a.data.titleImage&&game.load.image(t+"titleImage",a.data.titleImage);for(i=0;i<a.data.body.length;i++)game.load.image(t+"body_image"+i,a.data.body[i].image);""!=a.data.voice&&null!=a.data.voice&&game.load.audio("voice",a.data.voice);break;case"jigsaw":if(console.log("加载拼图题资源数据",a.data),""!=a.data.title_img&&null!=a.data.title_img&&game.load.image(t+"title_img",a.data.title_img),0<a.data.item.length)for(i=0;i<a.data.item.length;i++)""!=a.data.item[i].image&&(console.log("加载拼图题资111111源数据",a.data.item[i].image),game.load.image(t+"item_image"+i,a.data.item[i].image));for(i=0;i<a.data.groupA.length;i++)game.load.image(t+"groupA_image"+i,a.data.groupA[i].image);for(s=0;s<a.data.groupB.length;s++)game.load.image(t+"groupB_image"+s,a.data.groupB[s].image);break;case"cation":if(""!=a.data.title_img&&null!=a.data.title_img&&game.load.image(t+"title_img",a.data.title_img),0<a.data.item.length)for(i=0;i<a.data.item.length;i++)""!=a.data.item[i].image&&game.load.image(t+"item_image"+i,a.data.item[i].image);for(i=0;i<a.data.groupA.length;i++)game.load.image(t+"groupA_image"+i,a.data.groupA[i].image);for(s=0;s<a.data.groupB.length;s++)game.load.image(t+"groupB_image"+s,a.data.groupB[s].image);break;case"drow":if(""!=a.data.title_img&&null!=a.data.title_img&&game.load.image(t+"title_img",a.data.title_img),0<a.data.item.length)for(i=0;i<a.data.item.length;i++)""!=a.data.item[i].image&&game.load.image(t+"item_image"+i,a.data.item[i].image);game.load.image(t+"lin_start",a.data.linIcon.start),game.load.image(t+"lin_end",a.data.linIcon.end);break;case"newdraw":var n;if(n=a.data.other_images)for(i=0;i<n.length;i++)game.load.image(t+"other_images"+i+"temp",n[i].image)}}},this.create=function(){game.state.start("statemanager")}}),game.state.add("statemanager",function(){this.init=function(){null==game.stateIndex&&(game.stateIndex=0),game.data=json_data.courseware},this.preload=function(){},this.create=function(){null!=game.willGo&&(game.stateIndex=game.willGo,game.willGo=void 0),game.stateIndex<0&&(game.stateIndex=0);var t=game.data[game.stateIndex];null!=t&&(clearInterval(game.temp_t),game.state.start(t.state,!0,!1,t.data),game.loaded=!0)}}),gameAdmissionAnimations=function(t,e,a,i){if(t)switch(t){case"left":console.log("展示数据==动画=3=",a,i),e.alpha=1,e.x=game.width+500,game.add.tween(e).to({x:a,y:i},1800,null,!0,0,0);break;case"left1":e.alpha=1,console.log("展示数据==动画=4=",a,i),e.x=-1e3,game.add.tween(e).to({x:a,y:i},1800,null,!0,0,0);break;case"left2":e.alpha=1,console.log("展示数据==动画=5=",a,i),game.add.tween(e).to({x:a+1e3,y:i},1800,null,!0,0,0);break;case"Gradient":e.alpha=0,game.add.tween(e).to({alpha:[.1,.6]},1800,null,!0,0,0);case"Gradient1":e.alpha=0,game.add.tween(e).to({alpha:[.1,1]},1800,null,!0,0,0)}},gameDisplayAnimations=function(t,e,a,i){if(t)switch(t){case"rotate":e.anchor.setTo(.5,.5),game.add.tween(e).to({angle:360},7e3,Phaser.Easing.Bounce.Outue,!0,1,!1);break;case"zoom":game.add.tween(e).to({width:e.width+40,height:e.height+40},300,null,!0,0,2,!0)}},gameErrorAnimations=function(){game.sound.play("wrong");var t=game.add.image(game.width/2-150,434,"wrongImage");t.animations.add("run"),t.animations.play("run",12,null,1),setTimeout(function(){gameManager.sendScore(0,100,-1)},1e3)},gameLoadingAnimation=function(t){var e=game.add.image(354.5,236,"loading1"),a=game.add.image(458,347,"loading2");a.anchor.setTo(.5,.5);var i=game.add.image(560,307,"loading3");i.anchor.setTo(.5,.5);var s=game.add.image(575,387,"loading4");s.anchor.setTo(.5,.5),t?(game.add.tween(a).to({angle:360},8e3,"Linear",!0,1,!1),game.add.tween(s).to({angle:-360},6e3,"Linear",!0,1,!1),game.add.tween(i).to({angle:360},5e3,"Linear",!0,1,!1)):e.alpha=i.alpha=s.alpha=a.alpha=0},gameScoreAnimtions=function(){var t=game.add.image(game.world.centerX,game.height,"balls",4);game.add.tween(t).to({x:[game.world.centerX],y:[game.height,800,game.world.centerY],alpha:[1,.5,0]},800,Phaser.Easing.Bounce.Outue,!0,0,0),setTimeout(function(){var t=game.add.emitter(game.world.centerX,game.world.centerY,200);t.makeParticles("balls",[0,1,2,3,4,5]),t.minParticleSpeed.setTo(-800,-800),t.maxParticleSpeed.setTo(900,900),t.minParticleScale=.5,t.maxParticleScale=2,t.gravity=150,t.bounce.setTo(.5,.5),t.angularDrag=60,t.explode(2e3,300),setTimeout(function(){console.log("销毁颗粒==1==="),t.destroy()},2e3)},800)},testgameScoreAnimtions=function(){var t=game.world.centerX,e=game.height-10,i=game.add.emitter(t,e,400);i.makeParticles("test_balls",[0,1,2,3,4,5]),i.minParticleSpeed.setTo(-700,-700),i.maxParticleSpeed.setTo(1e3,1e3),i.minParticleScale=.5,i.maxParticleScale=1,i.gravity=100,i.bounce.setTo(.5,.5),i.angularDrag=65,i.explode(2e3,200),setTimeout(function(){console.log("==销毁例子=="),i.destroy(),function(t,e){(i=game.add.emitter(game.world.centerX,-10,400)).makeParticles("test_balls",[0,1,2,3,4,5]),i.setRotation(0,40),i.setScale(.6,.9),i.setYSpeed(t,e),i.width=1.5*game.world.width,i.gravity=600,i.start(!1,5e3,100);var a=game.add.emitter(game.world.centerX,-10,400);a.makeParticles("test_balls",[0,1,2,3,4,5]),a.setRotation(0,40),a.setScale(.3,1),a.setYSpeed(t+100,e+100),a.width=game.world.width-600,a.gravity=600,a.start(!1,5e3,100),setTimeout(function(){console.log("==销毁例子2=="),i.destroy(),a.destroy()},3e3)}(100,200)},2e3),setTimeout(function(){var t,e,a;t=100,e=200,(a=game.add.emitter(game.world.centerX,game.height+10,400)).makeParticles("qiqiu",[0,1,2,3,4,5]),a.setRotation(0,40),a.setYSpeed(t,e),a.width=900,a.gravity=-600,a.start(!1,5e3,100),setTimeout(function(){console.log("==销毁例子3=="),a.destroy()},4e3)},1e3)};var is_gulp=game.btn=!1;function gameCommon(t){gameManager.is_teacher||(is_gulp=!1,game.startImage=game.add.image(846,21.5,"startNum"),game.startImage.width=.5*game.startImage.width,game.startImage.height=.5*game.startImage.height,game.startCont&&parseInt(game.startCont.text)>gameManager.starsNum&&(gameManager.starsNum=game.startCont.text),game.startCont=game.add.text(925,42,gameManager.starsNum,{fill:"#ffffff",fontSize:20}),gameManager.versionType&&(game.gulp_btn=game.add.button(750,30,"tv_btn_team",gulpView,this,1,0,1,0),game.gulp_btn.width=58,game.gulp_btn.height=58))}this.next=function(t){gameManager.nextPage()},this.pre=function(t){gameManager.perPage()};var show_gulp=!1,is_showTime=!1;function gulpView(t){var e=document.getElementById("gulp_view");if(is_showTime)return!1;if(show_gulp){e.setAttribute("style","display:none;");for(var a=document.getElementById("gulp_container"),i=a.getElementsByTagName("li"),s=0;s<i.length;s++)a.removeChild(a.getElementsByTagName("li")[s]),s--;return show_gulp=!1}setTimeout(function(){is_showTime=!1},100),show_gulp=is_showTime=!0,gameManager.requestStudentsList()}function testGILP(){var t=[{name:"I'm ",avatar:"http://image.firstleap.cn/image/20170527/1495875090FKQY.jpg",uid:945,realname:null,sex:"女",classroomStart:"11",online:1,stars:79},{name:"Fiyy",avatar:"http://image.firstleap.cn/image/20170603/1496465036HILQ.jpg",uid:1006,realname:"'test'",sex:"女",classroomStart:"32",online:1,stars:1195},{name:"test1",avatar:"http://image.firstleap.cn/image/20161111/1478834115041.png",uid:46941,realname:"test1",online:0,sex:"男",classroomStart:"31",stars:288},{name:"test2",avatar:"http://image.firstleap.cn/image/20150714/1436867592NTPP.jpg",uid:46942,realname:"test2",sex:"男",classroomStart:"17",online:1,stars:567},{name:"test3",avatar:"",uid:46943,realname:"test3",sex:"女",classroomStart:"6",online:0,stars:360},{name:"test4",avatar:"",uid:46944,realname:"test4",sex:"",classroomStart:"4",online:0,stars:10},{name:"test5",avatar:"",uid:46945,realname:"test5",online:1,sex:"",classroomStart:"5",stars:0},{name:"test6",avatar:"",uid:46946,realname:"test6",sex:"",classroomStart:"10",stars:0},{name:"test7",avatar:"",uid:46947,realname:"test7",online:0,sex:"",classroomStart:"25",stars:0}],e=[],a=[],i=document.getElementById("gulp_view"),s=document.getElementById("gulp_container");if(is_gulp)return is_gulp=!1,void function(){i.setAttribute("style","display:none;");for(var t=s.getElementsByTagName("li"),e=0;e<t.length;e++)s.removeChild(s.getElementsByTagName("li")[e]),e--}();if(is_gulp=!0,i.setAttribute("style","display:block;"),t)for(var n=0;n<t.length;n++)t[n].uid==self.uid&&s.appendChild(d(n,t[n])),t[n].online&&1==t[n].online?a.push(t[n]):e.push(t[n]);for(var o=0;o<a.length;o++)s.appendChild(l(o,a[o]));for(var r=0;r<e.length;r++)s.appendChild(g(r,e[r]));function d(t,e){e.avatar||(e.avatar="//tv.firstleap.cn/tv/placeholder_monkey_round.png");var a=document.createElement("li");return a.innerHTML='<p class="gulp_avator"> <span class="actor_me">我</span> <img src="'+e.avatar+'"> </p><p class="gulp_en_name">'+e.name+"</p>",a}function l(t,e){e.avatar||(e.avatar="//tv.firstleap.cn/tv/placeholder_monkey_round.png");var a=document.createElement("li");return a.innerHTML='<p class="gulp_avator"> <img src="'+e.avatar+'"> </p><p class="gulp_en_name">'+e.name+"</p>",a}function g(t,e){e.avatar||(e.avatar="//tv.firstleap.cn/tv/placeholder_monkey_round.png");var a=document.createElement("li");return a.innerHTML='<p class="gulp_avator gray"> <img src="'+e.avatar+'"> </p><p class="gulp_en_name gray_name">'+e.name+"</p>",a}}function ScoreAnimtions(t){if(0!=t&&null!=t){var e=game.add.image(game.world.centerX,game.height,"balls",4);game.add.tween(e).to({x:[game.world.centerX],y:[game.height,800,game.world.centerY],alpha:[1,.5,0]},800,Phaser.Easing.Bounce.Outue,!0,0,0),console.log("dddddd",Phaser.Easing.Bounce.Outue),setTimeout(function(){var t=game.add.emitter(game.world.centerX,game.world.centerY,200);t.makeParticles("balls",[0,1,2,3,4,5]),t.minParticleSpeed.setTo(-800,-800),t.maxParticleSpeed.setTo(900,900),t.minParticleScale=.5,t.maxParticleScale=2,t.gravity=150,t.bounce.setTo(.5,.5),t.angularDrag=60,t.explode(2e3,300)},800);var a=[],i=Math.ceil(2*Math.random()),s=Math.ceil(4*Math.random());console.log("播放相应音频====",i);for(var n=0;n<gameManager.start;n++){var o=game.add.image(0,0,"start");o.anchor.setTo(.5,.5),a.push(o),o.width=o.height=.5*o.width,o.alpha=0}switch(gameManager.start){case 3:1==i&&game.sound.play("startAdded"),2==i&&game.sound.play("fantastic"),setTimeout(function(){game.sound.stopAll(),game.sound.play("startCollected"),log("3333"),AddStart(t),game.add.tween(a[0]).to({x:[500,880],y:[600,20],width:[100,80,60,40],height:[100,80,60,40],alpha:[1,.5,0]},800,Phaser.Easing.Bounce.Outue,!0,0,0),setTimeout(function(){game.add.tween(a[1]).to({x:[500,880],y:[600,20],alpha:[1,.5,0]},800,Phaser.Easing.Bounce.Outue,!0,0,0),setTimeout(function(){game.add.tween(a[2]).to({x:[500,880],y:[600,20],alpha:[1,.5,0]},800,Phaser.Easing.Bounce.Outue,!0,0,0)},400)},400)},1e3);break;case 2:log("222"),1==s&&game.sound.play("Sound_Wow_stupendous"),2==s&&game.sound.play("Sound_Super"),3==s&&game.sound.play("Sound_Wonderful"),4==s&&game.sound.play("Sound_Awesome"),setTimeout(function(){game.sound.stopAll(),AddStart(t),game.sound.play("startCollected"),game.add.tween(a[0]).to({x:[500,880],y:[600,20],width:[100,80,60,40],height:[100,80,60,40],alpha:[1,.5,0]},800,Phaser.Easing.Bounce.Outue,!0,0,0),setTimeout(function(){game.add.tween(a[1]).to({x:[500,880],y:[600,20],alpha:[1,.5,0]},800,Phaser.Easing.Bounce.Outue,!0,0,0)},400)},1e3);break;case 1:log("111"),game.sound.play("Sound_Great"),AddStart(t),setTimeout(function(){game.sound.stopAll(),game.sound.play("startCollected"),game.add.tween(a[0]).to({x:[500,880],y:[600,20],width:[100,80,60,40],height:[100,80,60,40],alpha:[1,.5,0]},800,Phaser.Easing.Bounce.Outue,!0,0,0)},1e3)}}}this.AddStart=function(t){gameManager.addRecord(t)},function(t){var g=function(t,e){this.x=t,this.y=e},l=new g(0,0),h=.5*Math.sqrt(125e3),u=15*Math.PI/180,c=2*Math.PI/180,m=.5*(-1+Math.sqrt(5)),p=function(t,e){for(var a=S(t)/(e-1),i=0,s=new Array(t[0]),n=1;n<t.length;n++){var o=I(t[n-1],t[n]);if(a<=i+o){var r=t[n-1].x+(a-i)/o*(t[n].x-t[n-1].x),d=t[n-1].y+(a-i)/o*(t[n].y-t[n-1].y),l=new g(r,d);s[s.length]=l,t.splice(n,0,l),i=0}else i+=o}return s.length==e-1&&(s[s.length]=new g(t[t.length-1].x,t[t.length-1].y)),s},f=function(t){var e=x(t);return Math.atan2(e.y-t[0].y,e.x-t[0].x)},_=function(t,e){for(var a=x(t),i=Math.cos(e),s=Math.sin(e),n=new Array,o=0;o<t.length;o++){var r=(t[o].x-a.x)*i-(t[o].y-a.y)*s+a.x,d=(t[o].x-a.x)*s+(t[o].y-a.y)*i+a.y;n[n.length]=new g(r,d)}return n},v=function(t,e){for(var a=r(t),i=new Array,s=0;s<t.length;s++){var n=t[s].x*(e/a.width),o=t[s].y*(e/a.height);i[i.length]=new g(n,o)}return i},b=function(t,e){for(var a=x(t),i=new Array,s=0;s<t.length;s++){var n=t[s].x+e.x-a.x,o=t[s].y+e.y-a.y;i[i.length]=new g(n,o)}return i},y=function(t){for(var e=0,a=new Array,i=0;i<t.length;i++)a[a.length]=t[i].x,a[a.length]=t[i].y,e+=t[i].x*t[i].x+t[i].y*t[i].y;var s=Math.sqrt(e);for(i=0;i<a.length;i++)a[i]/=s;return a},w=function(t,e,a){var i=_(t,a);return s(i,e)},x=function(t){for(var e=0,a=0,i=0;i<t.length;i++)e+=t[i].x,a+=t[i].y;return e/=t.length,a/=t.length,new g(e,a)},r=function(t){for(var e=1/0,a=-1/0,i=1/0,s=-1/0,n=0;n<t.length;n++)e=Math.min(e,t[n].x),i=Math.min(i,t[n].y),a=Math.max(a,t[n].x),s=Math.max(s,t[n].y);return new function(t,e,a,i){this.x=t,this.y=e,this.width=a,this.height=i}(e,i,a-e,s-i)},s=function(t,e){for(var a=0,i=0;i<t.length;i++)a+=I(t[i],e[i]);return a/t.length},S=function(t){for(var e=0,a=1;a<t.length;a++)e+=I(t[a-1],t[a]);return e},I=function(t,e){var a=e.x-t.x,i=e.y-t.y;return Math.sqrt(a*a+i*i)},A=function(t,e){var a=[],i=[];for(var s in t)null!=t[s].x&&null!=t[s].y&&a.push(t[s]);for(var n in e)null!=e[n].x&&null!=e[n].y&&i.push(e[n]);if(0==a.length||0==i.length)return 0;a=p(a,64);var o=f(a);a=_(a,-o),a=v(a,250),a=b(a,l);y(a);i=p(i,64);var r=f(i);i=_(i,-r),i=v(i,250),i=b(i,l);y(i);var d=1-function(t,e,a,i,s){for(var n=m*a+(1-m)*i,o=w(t,e,n),r=(1-m)*a+m*i,d=w(t,e,r);Math.abs(i-a)>s;)o<d?(i=r,r=n,d=o,o=w(t,e,n=m*a+(1-m)*i)):(a=n,n=r,o=d,d=w(t,e,r=(1-m)*a+m*i));return Math.min(o,d)}(a,i,-u,+u,c)/h;return d<=0&&(d=Number((.4*Math.random()+.5).toFixed(2))),isNaN(d)&&(d=Number((.4*Math.random()+.5).toFixed(2))),d};t.newDrawGetScore=function(t,e){var a=JSON.parse(JSON.stringify(t)),i=JSON.parse(JSON.stringify(e)),s=[],n={score_list:[],score:-1,all_score:0,avg_scores:0};if(0==a.length||0==i.length)return n;var o=0,r=[],d=[];for(var l in i){var g=0,h=a[l],u=i[l];for(var c in null==h?g=0:(g=A(h,u),isNaN(g)&&(g=0)),o+=g,s.push(g),u)null!=u[c].x&&null!=u[c].y&&d.push(u[c]);h=[],u=[]}for(var m in a)for(var c in h=a[m])null!=h[c].x&&null!=h[c].y&&r.push(h[c]);return n.score_list=s,n.score_avg=o/s.length,n.all_score=A(r,d),n.score=(100*(.7*n.all_score+.3*n.score_avg)).toFixed(2),(n.score<0||100<n.score)&&(n.score=-1),n}}(window);var headers=document.getElementById("headers"),oFirst=document.getElementById("first"),oSecond=document.getElementById("second"),aA=document.getElementById("a1"),aB=document.getElementById("a2");aA.onclick=function(){oFirst.style.display="block",oSecond.style.display="none",headers.className="head"},aB.onclick=function(){oFirst.style.display="none",oSecond.style.display="block",headers.className="head_bg"},function(t,o){var e="19993";o.state.add(e,function(){var a=this,i=!0,l=0,g=0;this.init=function(t){o.scale.pageAlignHorizontally=!0,o.scale.pageAlignVertically=!0,o.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,o.stage.setBackgroundColor(16777215),i=!0,isAnswer=!1,this.dianji=!1,this.data=t,!1,this.fensu=0,this.wrong=!1,this.buttonId=null,this.body_group=null,this.game_but=null,this.isAnswer=!1,this.TwisRunning=!1,this.bmd=null,this.bmdbg=null,this.answerbmd=null,this.poss=new Object,this.poss.xs=new Array,this.poss.ys=new Array,this.answerColor="#e2dfdfcc",this.answerPos={x:300,y:140},this.answerPaints=[[[161.5,29],[161.290966,29.558306],[160.680928,31.187648],[159.695482,33.819662],[158.360224,37.385984],[156.70075,41.81825],[154.742656,47.048096],[152.511538,53.007158],[150.032992,59.627072],[147.332614,66.839474],[144.436,74.57600000000001],[141.368746,82.76828600000002],[138.15644799999998,91.34796800000002],[134.824702,100.24668200000004],[131.39910399999997,109.39606400000005],[127.90524999999998,118.72775000000004],[124.36873599999997,128.17337600000005],[120.81515799999997,137.66457800000006],[117.27011199999997,147.1329920000001],[113.75919399999998,156.5102540000001],[110.30799999999996,165.72800000000012],[106.94212599999997,174.7178660000001],[103.68716799999996,183.41148800000008],[100.56872199999995,191.74050200000008],[97.61238399999996,199.6365440000001],[94.84374999999996,207.03125000000006],[92.28841599999997,213.85625600000012],[89.97197799999995,220.04319800000013],[87.92003199999996,225.52371200000007],[86.15817399999996,230.22943400000008],[84.71199999999997,234.0920000000001],[83.60710599999999,237.04304600000006],[82.869088,239.01420800000005],[82.52354199999999,239.93712200000004]],[[161,29],[161.203742,29.558306],[161.798336,31.187648],[162.758834,33.819662],[164.060288,37.385984],[165.67775,41.81825],[167.586272,47.048096],[169.760906,53.007158],[172.176704,59.627072],[174.808718,66.839474],[177.632,74.57600000000001],[180.621602,82.76828600000002],[183.752576,91.34796800000002],[186.999974,100.24668200000004],[190.338848,109.39606400000005],[193.74425000000002,118.72775000000004],[197.191232,128.17337600000005],[200.65484600000002,137.66457800000006],[204.11014400000005,147.1329920000001],[207.53217800000004,156.5102540000001],[210.89600000000002,165.72800000000012],[214.17666200000002,174.7178660000001],[217.34921600000004,183.41148800000008],[220.38871400000002,191.74050200000008],[223.27020800000003,199.6365440000001],[225.96875000000003,207.03125000000006],[228.45939200000004,213.85625600000012],[230.71718600000003,220.04319800000013],[232.71718400000003,225.52371200000007],[234.43443800000006,230.22943400000008],[235.84400000000002,234.0920000000001],[236.92092200000002,237.04304600000006],[237.64025600000002,239.01420800000005],[237.977054,239.93712200000004]],[[109.5,181.5],[109.787091,181.506615],[110.624928,181.52592],[111.978357,181.557105],[113.812224,181.59936],[116.091375,181.651875],[118.780656,181.71384],[121.84491299999999,181.784445],[125.248992,181.86288],[128.957739,181.948335],[132.936,182.04],[137.14862100000002,182.137065],[141.560448,182.23872],[146.13632700000002,182.344155],[150.84110400000003,182.45256],[155.63962500000002,182.563125],[160.49673600000006,182.67504],[165.37728300000003,182.787495],[170.24611200000004,182.89968],[175.06806900000004,183.010785],[179.80800000000005,183.12],[184.43075100000004,183.226515],[188.90116800000004,183.32952],[193.18409700000007,183.428205],[197.24438400000005,183.52176],[201.04687500000006,183.609375],[204.55641600000004,183.69024],[207.73785300000006,183.763545],[210.55603200000004,183.82848],[212.97579900000005,183.884235],[214.96200000000007,183.93],[216.47948100000005,183.964965],[217.493088,183.98832],[217.967667,183.999255]]],this.paintColor="#f12525",this.paintSize=45,this.PaintRoute=[],this.groupB=null},this.preload=function(){},this.addTitle=function(){""!=this.data.title_img&&null!=this.data.title_img&&o.add.image(this.data.text_pos.x,this.data.text_pos.y,o.stateIndex+"title_img")},this.roleInit=function(){if(o.is_teacher){var t=o.add.image(60,550,"go");this.game_but=o.add.text(5,10,"GO",{fill:"#000000",fontSize:60,fontWeight:"normal",boundsAlignH:"center",boundsAlignV:"middle"}),this.game_but.setTextBounds(35,38,32,30),t.addChild(this.game_but),this.game_but.inputEnabled=!0;var a=this;this.game_but.events.onInputUp.add(function(){if(!i)return!1;if(i){i=!1;var t=9,e=setInterval(function(){if(0===--t)return a.game_but.text="END",a.game_but.fontSize=40,16119285,a.game_but.style.color=13434880,clearInterval(e),i=!0,!1;a.game_but.text=t+"s"},1e3)}gameManager.startTesting()})}else o.show_mengban(),o.progressBar=this.add_progress_bar(0,0,758),o.progressBar.alpha=0},this.addGroupA=function(){this.groupA=o.add.group(),this.groupA.enableBody=!0,this.groupA.physicsBodyType=Phaser.Physics.ARCADE;for(var t=0;t<this.data.groupA.length;t++){var e=this.data.groupA[t];null==e.pos&&""==e.pos||this.groupA.create(e.pos.x,e.pos.y,o.stateIndex+"groupA_image"+t)}for(var a in this.groupA.children)this.groupA.children[a].id=a,this.groupA.children[a].answer=this.data.groupA[a].answer},this.addGroupB=function(){this.groupB=o.add.group(),this.groupB.enableBody=!0,this.groupB.physicsBodyType=Phaser.Physics.ARCADE;for(var t=0;t<this.data.groupB.length;t++){var e=this.data.groupB[t];null==e.pos&&""==e.pos||this.groupB.create(e.pos.x,e.pos.y,o.stateIndex+"groupB_image"+t)}},this.judgeAnswer=function(){},this.addItme=function(){if(""!=this.data.item&&null!=this.data.item)for(var t=0;t<this.data.item.length;t++)""!=this.data.item[t].image&&o.add.image(this.data.item[t].pos.x,this.data.item[t].pos.y,o.stateIndex+"item_image"+t)},this.paint=function(t,e,a,i,s){if(isAnswer)if(t.isDown){this.poss.xs.push(t.x),this.poss.ys.push(t.y);for(var n=0;n<=1;n+=.001){var o=this.math.catmullRomInterpolation(this.poss.xs,n),r=this.math.catmullRomInterpolation(this.poss.ys,n);isNaN(o)||this.bmd.draw(this.bmd2,o,r)}}else this.poss.xs=new Array,this.poss.ys=new Array},this.end=function(){for(var t=[],e=0;e<this.poss.xs.length;e++){var a=this.poss.xs[e],i=this.poss.ys[e];t.push([a,i])}this.poss.xs=[],this.poss.ys=[],this.PaintRoute.push(t),console.log("=检查笔画num=",this.PaintRoute.length),console.log("=路径检查=",this.PaintRoute),console.log("=第一笔画=",this.PaintRoute[l])},this.playback=function(n){!0;var o=this,r=0,d=setInterval(function(){if(r++,l==o.PaintRoute.length)return l=0,clearInterval(d),!1;if(r==n.length){if(clearInterval(d),1<o.PaintRoute.length){if(l==o.PaintRoute.length)return l=0,clearInterval(d),!1;l++,o.playback(o.PaintRoute[l])}}else for(var t=0;t<=1;t+=.001){var e=[n[r-1][0],[n[r][0]]],a=[n[r-1][1],[n[r][1]]],i=o.math.catmullRomInterpolation(e,t),s=o.math.catmullRomInterpolation(a,t);isNaN(i)||isNaN(s)||o.bmd.draw(o.bmd2,i,s)}},100)},this.playbackAnswer=function(n){var o=this,r=0;!0;var d=setInterval(function(){if(r++,g==o.answerPaints.length)return g=0,isAnswer=!0,clearInterval(d),!1;if(r==n.length){if(clearInterval(d),1<o.answerPaints.length){if(g==o.answerPaints.length)return g=0,isAnswer=!0,clearInterval(d),!1;g++,o.playbackAnswer(o.answerPaints[g])}}else for(var t=0;t<=1;t+=.01){var e=[n[r-1][0],[n[r][0]]],a=[n[r-1][1],[n[r][1]]],i=o.math.catmullRomInterpolation(e,t),s=o.math.catmullRomInterpolation(a,t);isNaN(i)||isNaN(s)||o.answerbmd.draw(o.bmd3,i+o.answerPos.x,s+o.answerPos.y)}},100)},this.errorPlayLine=function(t){this.bmd.clear(),this.PaintRoute=[]},this.create=function(){console.log("===测试绘画===",this.data),this.answerbmd=o.make.bitmapData(1024,768),this.answerbmd.addToWorld(0,0),this.bmd3=o.make.bitmapData(this.paintSize,this.paintSize),this.bmd3.circle(1,1,this.paintSize,this.answerColor),this.playbackAnswer(this.answerPaints[0]),this.bmd=o.make.bitmapData(1024,768),this.bmd.addToWorld(0,0),this.bmdbg=o.add.image(0,0,this.bmd),this.bmd2=o.make.bitmapData(this.paintSize,this.paintSize),this.bmd2.circle(1,1,this.paintSize,this.paintColor),this.groupB=o.add.group(),this.groupB.enableBody=!0,this.groupB.physicsBodyType=Phaser.Physics.ARCADE,this.groupB.create(0,0,"go"),console.log("拖拽元素默认坐标",this.answerPaints[0][0][0],this.answerPaints[0][0][1]),this.groupB.children[0].x=this.answerPaints[0][0][0]+this.answerPos.x-12,this.groupB.children[0].y=this.answerPaints[0][0][1]+this.answerPos.y,this.groupB.children[0].width=this.groupB.children[0].height=this.paintSize;var t=this.groupB.children[0];t.inputEnabled=!0,t.input.enableDrag(),t.events.onDragStop.add(this.DragStop,this),t.events.onDragStart.add(this.DragStart,this),t.events.onDragUpdate.add(this.onDragUpdate,this),t.oldx=this.answerPaints[0][0][0]+this.answerPos.x-12,t.oldy=this.answerPaints[0][0][1]+this.answerPos.y,gameCommon(),this.roleInit()},this.DragStart=function(t){},this.onDragUpdate=function(t){for(var e=[],a=[],i=0;i<this.answerPaints[0].length;i++)e.push(this.answerPaints[0][i][0]+this.answerPos.x-12),a.push(this.answerPaints[0][i][1]+this.answerPos.y);this.deviation(e,a,t.x,t.y,t)},this.deviation=function(t,e,a,i,s){for(var n=!1,o=!1,r=-1,d=0;d<t.length;d++){var l=t[d];parseInt(a)!=parseInt(l)||(n=!0)}for(var g=0;g<e.length;g++){var h=e[g];parseInt(i)!=parseInt(h)||(o=!0,r=g)}if(!o||!n)return console.log("区域=2==",r),-1;console.log("区域=1==",r),s.x=t[r],s.y=e[r]},this.DragStop=function(t){},this.render=function(){for(n in a.groupB.children)o.debug.body(a.groupB.children[n])};this.add_progress_bar=function(t,e,a){var i=o.add.graphics(0,0);i.beginFill(4443520),i.drawRect(0,0,o.width,10),i.endFill();var s=o.add.sprite(e,a,i.generateTexture());return i.destroy(),s},this.submitScore=function(t,e){a.wrong,gameManager.stars(Math.round(t)),0!=t&&(o.progressBar&&(o.progressBar.alpha=1),ScoreAnimtions(t),console.log("星星数量==2===",gameManager.start),clearInterval(o.temp_t))},this.answers_startgame=function(){if(o.is_teacher&&null!=this.game_but){var t=this;if(!i)return!1;if("END"!=t.game_but.text&&i){i=!1;var e=9,a=setInterval(function(){if(0===--e)return t.game_but.text="END",t.game_but.fontSize=40,16119285,t.game_but.style.color=13434880,clearInterval(a),i=!0,!1;t.game_but.text=e+"s"},1e3)}"END"!=t.game_but.text&&gameManager.startTesting()}},this.startgame=function(t){null==t&&(t=7),o.progressBar.alpha=1,o.show_mengban(!0);o.add.tween(o.progressBar).to({width:0,alpha:0},8e3,Phaser.Easing.Linear.None,!0).onComplete.add(function(){a.submitScore(0,4)})}})}(window,game),function(t,g){g.state.add("10",function(){var l=this,i=!0;this.init=function(t){g.scale.pageAlignHorizontally=!0,g.scale.pageAlignVertically=!0,g.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,g.stage.setBackgroundColor(16777215),i=!0,this.dianji=!1,this.data=t,this.fensu=0,this.wrong=!1,this.buttonId=null,this.body_group=null,this.game_but=null,this.groupA=null,this.groupB=null,this.isAnswer=!1,this.TwisRunning=!1,this.random=!1;for(var e=this.answerNum=0;e<this.data.groupA.length;e++)this.answerNum=this.data.groupA[e].answer.length+this.answerNum;this.scoreNum=0},this.preload=function(){},this.addTitle=function(){""!=this.data.title_img&&null!=this.data.title_img&&g.add.image(this.data.text_pos.x,this.data.text_pos.y,g.stateIndex+"title_img")},this.roleInit=function(){if(g.is_teacher){var t=g.add.image(60,550,"go");this.game_but=g.add.text(5,10,"GO",{fill:"#000000",fontSize:60,fontWeight:"normal",boundsAlignH:"center",boundsAlignV:"middle"}),this.game_but.setTextBounds(35,38,32,30),t.addChild(this.game_but),this.game_but.inputEnabled=!0;var a=this;this.game_but.events.onInputUp.add(function(){if(!i)return!1;if(i){i=!1;var t=9,e=setInterval(function(){if(0===--t)return a.game_but.text="END",a.game_but.fontSize=40,16119285,a.game_but.style.color=13434880,clearInterval(e),i=!0,!1;a.game_but.text=t+"s"},1e3)}gameManager.startTesting()})}else g.show_mengban(),g.progressBar=this.add_progress_bar(0,0,758),g.progressBar.alpha=0},this.addGroupA=function(){this.groupA=g.add.group(),this.groupA.enableBody=!0,this.groupA.physicsBodyType=Phaser.Physics.ARCADE;for(var t=0;t<this.data.groupA.length;t++){var e=this.data.groupA[t];null==e.pos&&""==e.pos||this.groupA.create(e.pos.x,e.pos.y,g.stateIndex+"groupA_image"+t)}for(var a in this.groupA.children)this.groupA.children[a].id=a,this.groupA.children[a].answers=this.data.groupA[a].answer},this.addGroupB=function(){this.groupB=g.add.group(),this.groupB.enableBody=!0,this.groupB.physicsBodyType=Phaser.Physics.ARCADE;for(var t=0;t<this.data.groupB.length;t++){var e=this.data.groupB[t];null==e.pos&&""==e.pos||this.groupB.create(e.pos.x,e.pos.y,g.stateIndex+"groupB_image"+t)}for(var a in this.groupB.children)this.groupB.children[a].id=a,this.groupB.children[a].answer=!1,this.groupB.children[a].anchor.setTo(.5,.5);l.startAnswer()},this.startAnswer=function(){var t=n(this.data.groupB.length);if(this.random)t=n(this.data.groupB.length);for(var e in this.groupB.children){this.groupB.children[e].id=e;var a=this.groupB.children[e];if(this.random)var i=this.data.groupB[t[e]-1].pos.x+a.width/2,s=this.data.groupB[t[e]-1].pos.y+a.height/2;else i=this.data.groupB[e].pos.x+a.width/2,s=this.data.groupB[e].pos.y+a.height/2;this.groupB.children[e].old={x:i,y:s},a.inputEnabled=!0,a.input.enableDrag(),a.events.onDragStop.add(this.DragStop,this),a.events.onDragStart.add(this.DragStart,this),l.TwisRunning=!0,g.add.tween(a).to({x:i,y:s},400,null,!0,0,0).onComplete.add(function(){l.TwisRunning=!1})}function n(t){for(var e,a,i=[],s=0;s<t;s++){var n=(a=t+(e=1),parseInt(Math.random()*(a-e)+e));o(i,n)?s--:i.push(n)}function o(t,e){for(var a=0;a<t.length;a++)if(t[a]==e)return!0;return!1}return i}},this.DragStart=function(t){},this.DragStop=function(t){var e=g.physics.arcade.overlap(t,this.groupA,this.check_over,null,this);if(!e){console.log("没发生碰撞的",e);var a=t.old.x,i=t.old.y;g.add.tween(t).to({x:a,y:i},300,null,!0,0,0).onComplete.add(function(){g.sound.play("errolplay")})}},this.check_over=function(t,e){for(var a=0;a<e.answers.length;a++){if(t.id==e.answers[a]){var i=t.width+30,s=t.height+30,n=this.data.groupA[e.id].pos.x,o=this.data.groupA[e.id].pos.y,r=this.groupA.children[e.id].width/2,d=this.groupA.children[e.id].height/2;return g.add.tween(t).to({x:this.data.groupA[e.id].pos.x+r,y:this.data.groupA[e.id].pos.y+d},300,null,!0,0,0).onComplete.add(function(){t.anchor.setTo(.5,.5),g.sound.stopAll(),g.sound.play("goodplay"),g.add.tween(t).to({height:s,width:i,alpha:[1,.5,0]},400,Phaser.Easing.Bounce.Outue,!0,0,0).onComplete.add(function(){l.scoreNum=l.scoreNum+1,l.scoreNum==l.answerNum&&(console.log("全部答对"),l.submitScore(100)),t.inputEnabled=!1})}),!0}n=t.old.x,o=t.old.y;g.add.tween(t).to({x:n,y:o},300,null,!0,0,0).onComplete.add(function(){g.sound.stopAll(),g.sound.play("errolplay")})}},this.judgeAnswer=function(){return!0},this.addItme=function(){if(""!=this.data.item&&null!=this.data.item)for(var t=0;t<this.data.item.length;t++)""!=this.data.item[t].image&&g.add.image(this.data.item[t].pos.x,this.data.item[t].pos.y,g.stateIndex+"item_image"+t)},this.create=function(){console.log("进入分类==",this.data.item),this.addTitle(),this.addItme(),this.addGroupA(),this.addGroupB(),gameCommon(),this.roleInit()};this.add_progress_bar=function(t,e,a){var i=g.add.graphics(0,0);i.beginFill(4443520),i.drawRect(0,0,g.width,10),i.endFill();var s=g.add.sprite(e,a,i.generateTexture());return i.destroy(),s},this.submitScore=function(t,e){l.wrong,gameManager.stars(Math.round(t)),0!=t&&(g.progressBar&&(g.progressBar.alpha=1),ScoreAnimtions(t),console.log("星星数量==2===",gameManager.start),clearInterval(g.temp_t))},this.answers_startgame=function(){if(g.is_teacher&&null!=this.game_but){var t=this;if(!i)return!1;if("END"!=t.game_but.text&&i){i=!1;var e=9,a=setInterval(function(){if(0===--e)return t.game_but.text="END",t.game_but.fontSize=40,16119285,t.game_but.style.color=13434880,clearInterval(a),i=!0,!1;t.game_but.text=e+"s"},1e3)}"END"!=t.game_but.text&&gameManager.startTesting()}},this.startgame=function(t){null==t&&(t=7),g.progressBar.alpha=1,g.show_mengban(!0);g.add.tween(g.progressBar).to({width:0,alpha:0},8e3,Phaser.Easing.Linear.None,!0).onComplete.add(function(){l.submitScore(0,4)})}})}(window,game),function(t,s){s.state.add("01",function(){this.init=function(t){s.scale.pageAlignHorizontally=!0,s.scale.pageAlignVertically=!0,s.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,s.stage.setBackgroundColor(16777215),void 0===t&&(t={class:"Light Mystery",label:"live Broadcasting Class Pre-school"}),this.data=t},this.preload=function(){},this.create=function(){if(""!=this.data.background_image){var t=s.add.image(0,0,s.stateIndex+"cover-bg");t.width=s.width,t.height=s.height}var e;if(""!=this.data.overviewImage&&null!=this.data.overviewImage&&(e=s.add.image(this.data.pos.x,this.data.pos.y,s.stateIndex+"overviewImage"),""!=this.data.overviewAnimtion&&null!=this.data.overviewAnimtion&&gameDisplayAnimations(this.data.overviewAnimtion,e)),console.log("展示数据====",this.data),this.data.body)for(var a=0;a<this.data.body.length;a++)if(null!=this.data.body[a].image&&""!=this.data.body[a].image){console.log("展示数据==动画=1=",this.data.image);var i=s.add.image(this.data.body[a].pos.x,this.data.body[a].pos.y,s.stateIndex+"displayImage"+a);null!=this.data.body[a].imageAnimation&&""!=this.data.body[a].imageAnimation&&(console.log("展示数据==动画=2=",this.data.image),i.alpha=0,gameAdmissionAnimations(this.data.body[a].imageAnimation,i,this.data.body[a].pos.x,this.data.body[a].pos.y))}(""!=this.data.overviewImage&&null!=this.data.overviewImage||""!=this.data.background_image)&&gameCommon(),gameManager.tid!=gameManager.pageCount-1?gameCommon():gameCommon(!0);s.add.text(this.data.text_pos.x,this.data.text_pos.y,this.data.title,{fill:this.data.fill_color,fontSize:this.data.font_size})}})}(window,game),function(t,n){var h=0,u=0;n.state.add("13",function(){var d=this,i=!0,l=0,g=0;u=0,this.init=function(t){n.scale.pageAlignHorizontally=!0,n.scale.pageAlignVertically=!0,n.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,n.stage.setBackgroundColor(16777215),i=!0,isAnswer=!1,this.data=t,!1,this.score=0,this.wrong=!1,this.buttonId=null,this.game_but=null,this.isAnswer=!1,this.TwisRunning=!1,this.bmd=null,this.bmdbg=null,this.answerbmd=null,this.poss=new Object,this.poss.xs=new Array,this.poss.ys=new Array,this.answerColor=this.data.playcolor,this.answerPos={x:this.data.answerPos.x,y:this.data.answerPos.y},this.Zoom=this.data.zoom,this.answerPaints=this.data.Pdata,this.paintColor=this.data.paintColor,this.paintSize=this.data.paintSize,this.PaintRoute=[],this.groupB=null,this.pylaEnd=n.add.group;u=0,isSoundPlay=!1},this.preload=function(){},this.addTitle=function(){""!=this.data.title_img&&null!=this.data.title_img&&n.add.image(this.data.text_pos.x,this.data.text_pos.y,n.stateIndex+"title_img")},this.addGroupB=function(){for(var t in this.groupB=n.add.group(),this.groupB.enableBody=!0,this.groupB.physicsBodyType=Phaser.Physics.ARCADE,this.groupB.create(0,0,n.stateIndex+"lin_start"),this.groupB.children){var e=this.groupB.children[t];e.id=t,e.inputEnabled=!0,e.input.enableDrag(),e.events.onDragStop.add(this.DragStop,this),e.events.onDragStart.add(this.DragStart,this),e.events.onDragUpdate.add(this.onDragUpdate,this),e.width=e.height=this.paintSize,e.alpha=0}var a={x:this.answerPaints[0][0][0]+this.answerPos.x,y:this.answerPaints[0][0][1]+this.answerPos.y};this.groupB.children[0].x=a.x,this.groupB.children[0].y=a.y},this.addendGroup=function(){this.pylaEnd=n.add.group();for(var t=0;t<this.answerPaints.length;t++){var e=this.answerPaints[t][this.answerPaints[t].length-1][0]+this.answerPos.x,a=this.answerPaints[t][this.answerPaints[t].length-1][1]+this.answerPos.y;this.pylaEnd.create(e,a,n.stateIndex+"lin_end")}for(var i in this.pylaEnd.children){var s=this.pylaEnd.children[i];s.alpha=0,s.width=s.height=this.paintSize}},this.roleInit=function(){if(n.is_teacher){var t=n.add.image(60,550,"go");this.game_but=n.add.text(5,10,"GO",{fill:"#000000",fontSize:60,fontWeight:"normal",boundsAlignH:"center",boundsAlignV:"middle"}),this.game_but.setTextBounds(35,38,32,30),t.addChild(this.game_but),this.game_but.inputEnabled=!0;var a=this;this.game_but.events.onInputUp.add(function(){if(!i)return!1;if(i){i=!1;var t=9,e=setInterval(function(){if(0===--t)return a.game_but.text="END",a.game_but.fontSize=40,16119285,a.game_but.style.color=13434880,clearInterval(e),i=!0,!1;a.game_but.text=t+"s"},1e3)}gameManager.startTesting()})}else n.show_mengban(),n.progressBar=this.add_progress_bar(0,0,758),n.progressBar.alpha=0},this.judgeAnswer=function(){},this.addItme=function(){if(""!=this.data.item&&null!=this.data.item)for(var t=0;t<this.data.item.length;t++)""!=this.data.item[t].image&&n.add.image(this.data.item[t].pos.x,this.data.item[t].pos.y,n.stateIndex+"item_image"+t)},this.paint=function(t,e,a,i,s){if(isAnswer)if(t.isDown){this.poss.xs.push(t.x),this.poss.ys.push(t.y);for(var n=0;n<=1;n+=.001){var o=this.math.catmullRomInterpolation(this.poss.xs,n),r=this.math.catmullRomInterpolation(this.poss.ys,n);isNaN(o)||this.bmd.draw(this.bmd2,o,r)}}else this.poss.xs=new Array,this.poss.ys=new Array},this.end=function(){for(var t=[],e=0;e<this.poss.xs.length;e++){var a=this.poss.xs[e],i=this.poss.ys[e];t.push([a,i])}this.poss.xs=[],this.poss.ys=[],this.PaintRoute.push(t)},this.playback=function(n){!0;var o=this,r=0,d=setInterval(function(){if(r++,l==o.PaintRoute.length)return l=0,clearInterval(d),!1;if(r==n.length){if(clearInterval(d),1<o.PaintRoute.length){if(l==o.PaintRoute.length)return l=0,clearInterval(d),!1;l++,o.playback(o.PaintRoute[l])}}else for(var t=0;t<=1;t+=.001){var e=[n[r-1][0],[n[r][0]]],a=[n[r-1][1],[n[r][1]]],i=o.math.catmullRomInterpolation(e,t),s=o.math.catmullRomInterpolation(a,t);isNaN(i)||isNaN(s)||o.bmd.draw(o.bmd2,i,s)}},100)},this.playbackAnswer=function(n){var o=this,r=0;!0;var d=setInterval(function(){if(r++,g==o.answerPaints.length)return g=0,isAnswer=!0,o.groupB.children[0].alpha=1,o.pylaEnd.children[0].alpha=1,clearInterval(d),!1;if(r==n.length){if(clearInterval(d),1<o.answerPaints.length){if(g==o.answerPaints.length)return g=0,isAnswer=!0,clearInterval(d),!1;g++,o.playbackAnswer(o.answerPaints[g])}}else for(var t=0;t<=1;t+=.01){var e=[n[r-1][0],[n[r][0]]],a=[n[r-1][1],[n[r][1]]],i=o.math.catmullRomInterpolation(e,t),s=o.math.catmullRomInterpolation(a,t);isNaN(i)||isNaN(s)||o.answerbmd.draw(o.bmd3,i+o.answerPos.x,s+o.answerPos.y)}},100)},this.errorPlayLine=function(t){this.bmd.clear(),this.PaintRoute=[]},this.create=function(){console.log("===测试绘画===",this.data),this.addTitle(),this.answerbmd=n.make.bitmapData(n.width,n.height),this.answerbmd.addToWorld(0,0),this.bmd3=n.make.bitmapData(this.paintSize,this.paintSize),this.bmd3.circle(this.paintSize/2,this.paintSize/2,this.paintSize/2,this.answerColor),this.zoom(this.Zoom),this.playbackAnswer(this.answerPaints[0]),this.bmd=n.make.bitmapData(1024,768),this.bmd.addToWorld(0,0),this.bmdbg=n.add.image(0,0,this.bmd),this.bmd2=n.make.bitmapData(this.paintSize,this.paintSize),this.bmd2.circle(this.paintSize/2,this.paintSize/2,this.paintSize/2,this.paintColor),this.bmdbg.events.onInputUp.add(this.end,this),this.addendGroup(),this.addGroupB(),gameCommon(),this.roleInit()},this.zoom=function(t){for(var e=0;e<this.answerPaints.length;e++)for(var a=0;a<this.answerPaints[e].length;a++)this.answerPaints[e][a][0]=2*this.answerPaints[e][a][0],this.answerPaints[e][a][1]=2*this.answerPaints[e][a][1]},this.DragStart=function(t){if(isAnswer)return u==this.answerPaints.length?(console.log("所有都完成了s"),void(t.alpha=0)):void 0},this.onDragUpdate=function(t){if(isAnswer){if(u==this.answerPaints.length)return t.alpha=0,void t.destroy();var e=this;if(this.answerPaints[u][h]){e.soundPlay(),this.poss.xs.push(this.answerPaints[u][h][0]),this.poss.ys.push(this.answerPaints[u][h][1]),e.deviation(e.answerPaints[u],t.x,t.y,t);for(var a=0;a<=1;a+=.001){var i=this.math.catmullRomInterpolation(this.poss.xs,a),s=this.math.catmullRomInterpolation(this.poss.ys,a);isNaN(i)||this.bmd.draw(this.bmd2,i+e.answerPos.x,s+e.answerPos.y)}}else{this.answerPaints[u]=[],this.DragStop(t),this.pylaEnd.children[u].alpha=0,!((u+=1)>this.answerPaints.length-1)&&(this.pylaEnd.children[u].alpha=1),console.log("完成一笔",u,this.answerPaints.length),n.sound.stopAll();n.sound.play("errolplay");u==this.answerPaints.length&&(console.log("全部完成"),this.isAnswer=!1,this.score=100,this.submitScore(this.score)),h=1}}},this.soundPlay=function(){if(!d.isSoundPlay){n.sound.stopAll();var t=n.sound.play("goodplay");d.isSoundPlay=!0,setTimeout(function(){d.isSoundPlay=!1},1e3*t.duration)}},this.deviation=function(s,t,e,n){var a,o,r;isAnswer&&(a=s,o=n.x,r=n.y,a.map(function(t,e){var a=t[0]+d.answerPos.x,i=t[1]+d.answerPos.y;a<o&&o<a+n.width&&i<r&&r<i+n.height&&s[h]&&(h=e,d.groupB.children[0].x=s[h][0]+d.answerPos.x,d.groupB.children[0].y=s[h][1]+d.answerPos.y,d.answerPaints[u].splice(h,1))}),s[h]&&(n.x=s[h][0]+d.answerPos.x,n.y=s[h][1]+d.answerPos.y))},this.DragStop=function(t){if(isAnswer){if(u==this.answerPaints.length)return console.log("所有都完成了stop"),void(t.alpha=0);if(this.poss.xs=[],this.poss.ys=[],h==this.answerPaints[u].length-1||this.answerPaints[u]==[]){if(console.log("结束一笔"),(u+=1)==this.answerPaints.length)return console.log("所有都完成了"),t.alpha=0,this.isAnswer=!1,this.score=100,void this.submitScore(this.score);h=0,this.groupB.children[0].x=this.answerPaints[u][0][0]+this.answerPos.x,this.groupB.children[0].y=this.answerPaints[u][0][1]+this.answerPos.y}}};this.add_progress_bar=function(t,e,a){var i=n.add.graphics(0,0);i.beginFill(4443520),i.drawRect(0,0,n.width,10),i.endFill();var s=n.add.sprite(e,a,i.generateTexture());return i.destroy(),s},this.submitScore=function(t,e){d.wrong,gameManager.stars(Math.round(t)),0!=t&&(n.progressBar&&(n.progressBar.alpha=1),ScoreAnimtions(t),clearInterval(n.temp_t))},this.answers_startgame=function(){if(n.is_teacher&&null!=this.game_but){var t=this;if(!i)return!1;if("END"!=t.game_but.text&&i){i=!1;var e=9,a=setInterval(function(){if(0===--e)return t.game_but.text="END",t.game_but.fontSize=40,16119285,t.game_but.style.color=13434880,clearInterval(a),i=!0,!1;t.game_but.text=e+"s"},1e3)}"END"!=t.game_but.text&&gameManager.startTesting()}},this.startgame=function(t){null==t&&(t=7),n.progressBar.alpha=1,n.show_mengban(!0);n.add.tween(n.progressBar).to({width:0,alpha:0},8e3,Phaser.Easing.Linear.None,!0).onComplete.add(function(){0==this.score&&0!=this.StrokeNum?d.submitScore(70,4):d.submitScore(0,4)})}})}(window,game),function(t,g){g.state.add("06",function(){var o=this,r=!0;this.init=function(t){g.scale.pageAlignHorizontally=!0,g.scale.pageAlignVertically=!0,g.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,g.stage.setBackgroundColor(16777215),void 0===t&&(t={title:"",text:"",voice:"",image:"",pos:{},body:[{text:"",voice:"",allow:!0,image:"./states/shape-11/images/rec.png",pos:{x:150,y:450},size:{w:100,h:100}},{text:"",voice:"",allow:!0,image:"./states/shape-11/images/ari.png",pos:{x:400,y:450},size:{w:100,h:100}},{text:"",voice:"",allow:!0,image:"./states/shape-11/images/rou.png",pos:{x:630,y:450},size:{w:100,h:100}},{text:"",voice:"",allow:!0,image:"./states/shape-11/images/rect.png",pos:{x:850,y:450},size:{w:100,h:100}}],answer:0}),this.data=t,this.fensu=0,this.wrong=!1,this.buttonId=null,this.groupA=null,this.groupB=null,this.isPlaying=!1,this.isLineA=!1,this.isLineB=!1,this.start_x=null,this.start_y=null,this.stop_x1=null,this.stop_y1=null,this.stop_x2=null,this.stop_y2=null,this.linegroup=[],this.line_end=null,this.line_start=null,this.game_but=null};var e=[];this.preload=function(){},this.create=function(){var a=this,t=g.add.text(this.data.text_pos.x,this.data.text_pos.y,this.data.title,{fill:this.data.fill_color,fontSize:this.data.font_size,align:"center",boundsAlignH:"center"});t.setTextBounds(10,0,700,40),t.wordWrapWidth=900,t.wordWrap=!0,this.groupA=g.add.group(),this.groupB=g.add.group();for(var e=0;e<this.data.groupA.length;e++)""!=this.data.groupA[e].pos?(console.log(),this.groupA.add(g.add.button(this.data.groupA[e].pos.x,this.data.groupA[e].pos.y,g.stateIndex+"groupA"+e))):this.groupA.add(g.add.button(256+150*e,270,g.stateIndex+"groupA"+e));for(e=0;e<this.data.groupB.length;e++)""!=this.data.groupB[e].pos?this.groupB.add(g.add.button(this.data.groupB[e].pos.x,this.data.groupB[e].pos.y,g.stateIndex+"groupB"+e)):this.groupB.add(g.add.button(256+150*e,500,g.stateIndex+"groupB"+e));for(n in this.groupA.children){var i=this.groupA.children[n];i.id=n,i.checked=!1,i.line_k=null,i.onInputDown.add(function(t){a.onButton(t,null)}),i.align=.5}for(k in this.groupB.children){var s=this.groupB.children[k];s.id=k,s.checkedB=!1,s.line_k=null,s.align=.5,s.onInputDown.add(function(t){a.onButton(null,t)})}if(g.is_teacher){var o=g.add.image(60,550,"go");this.game_but=g.add.text(5,10,"GO",{fill:"#000000",fontSize:60,fontWeight:"normal",boundsAlignH:"center",boundsAlignV:"middle"}),this.game_but.setTextBounds(35,38,32,30),o.addChild(this.game_but),this.game_but.inputEnabled=!0;a=this;this.game_but.events.onInputUp.add(function(){if(!r)return!1;if(r){r=!1;var t=9,e=setInterval(function(){if(0===--t)return a.game_but.text="END",a.game_but.fontSize=40,16119285,a.game_but.style.color=13434880,clearInterval(e),r=!0,!1;a.game_but.text=t+"s"},1e3)}gameManager.startTesting()})}else g.show_mengban(),g.progressBar=this.add_progress_bar(0,0,0)};this.add_progress_bar=function(t,e,a){var i=g.add.graphics(0,0);i.beginFill(8900351),i.drawRect(0,0,g.width,5),i.endFill();var s=g.add.sprite(e,a,i.generateTexture());return i.destroy(),s};var d,l;this.onButton=function(t,e){var a={};if(null!=t){if(o.isLineA)return;if(o.isLineA=!0,null==o.start_x)return o.isLineB=!1,o.start_x=t.x+t.width/2,o.start_y=t.y+t.height,d="A"+t.id,l=t.id,void o.hider_mengban(!1,t,t.x,t.y);if(null!=o.start_x){if(o.hider_mengban(!0),a.start=d,a.end="A"+t.id,a.id1=l,a.id2=t.id,console.log("当前终点",a.end),null==a.end)return;o.stop_x1=t.x+t.width/2,o.stop_y1=t.y+t.height;var i=16619130;(s=g.add.graphics(0,0)).lineStyle(2.5,i),s.moveTo(o.start_x,o.start_y),s.lineTo(o.stop_x1,o.stop_y1),o.isLine=!1,a.body=s,o.line_check(a),o.linegroup.push(a),o.isLineA=!1,o.isLineB=!1,o.start_x=null}}if(null!=e){if(o.isLineB)return;if(o.isLineB=!0,null==o.start_x)return o.isLineA=!1,o.start_x=e.x+e.width/2,o.start_y=e.y,o.zbw=e.width/2,d="B"+e.id,l=e.id,void o.hider_mengban(!1,e,e.x,e.y);if(null!=o.start_x){if(o.hider_mengban(!0),a.id1=l,a.id2=e.id,a.start=d,a.end="B"+e.id,console.log("当前终点",a.end),null==a.end)return;o.stop_x2=e.x+e.width/2,o.stop_y2=e.y;var s;i=16619130;(s=g.add.graphics(0,0)).lineStyle(2.5,i),s.moveTo(o.start_x,o.start_y),s.lineTo(o.stop_x2,o.stop_y2),a.body=s,o.isLine=!1,o.isLineB=!1,o.isLineA=!1,o.start_x=null,o.line_check(a),o.linegroup.push(a)}}},this.hider_mengban=function(t,e,a,i){if(t)o.mengban.x=-1024;else{var s=g.add.graphics(0,0);s.beginFill(10025880),s.drawRect(0,0,e.width,e.height),o.mengban=g.add.image(a,i,s.generateTexture()),o.mengban.alpha=.5,s.destroy()}},this.line_check=function(t){if(""!=o.linegtoup){for(var e,a=0;a<o.linegroup.length;a++)t.start!=o.linegroup[a].start&&t.end!=o.linegroup[a].end&&t.body!=o.linegroup[a].body&&o.linegroup[a].start!=t.end&&o.linegroup[a].start!=t.start&&o.linegroup[a].end!=t.start&&t.start!=o.linegroup[a].end||(e=a,console.log("应该删除的数组",a,o.linegroup[e]),o.linegroup[e].body.destroy(),o.linegroup.splice(e,1));for(a=0;a<o.linegroup.length;a++)t.start!=o.linegroup[a].start&&t.end!=o.linegroup[a].end&&t.body!=o.linegroup[a].body&&o.linegroup[a].start!=t.end&&o.linegroup[a].start!=t.start&&o.linegroup[a].end!=t.start&&t.start!=o.linegroup[a].end||(e=a,console.log("应该删除的数组",a,o.linegroup[e]),o.linegroup[e].body.destroy(),o.linegroup.splice(e,1));console.log("选完数组",o.linegroup)}},this.submitScore=function(t,e){o.wrong&&(e=4),gameManager.sendScore(Math.round(t),100,e),clearInterval(g.temp_t)},this.check_answer=function(){if(console.log("答案数组",o.linegroup,e),o.linegroup.length!=this.groupB.children.length)return!1;for(var t=0;t<o.linegroup.length;t++)if(o.linegroup[t].id1!=o.linegroup[t].id2)return!1;return!0},this.answers_startgame=function(){if(g.is_teacher&&null!=this.game_but){var t=this;if(!r)return!1;if("END"!=t.game_but.text&&r){r=!1;var e=9,a=setInterval(function(){if(0===--e)return t.game_but.text="END",t.game_but.fontSize=40,16119285,t.game_but.style.color=13434880,clearInterval(a),r=!0,!1;t.game_but.text=e+"s"},1e3)}"END"!=t.game_but.text&&gameManager.startTesting()}},this.startgame=function(t){for(n in null==t&&(t=10),this.groupA.children){this.groupA.children[n].align=1}for(k in this.groupB.children){this.groupB.children[k].align=1}g.progressBar.alpha=1,g.show_mengban(!0);g.add.tween(g.progressBar).to({width:0,alpha:0},8e3,Phaser.Easing.Linear.None,!0),g.temp_t=setInterval(function(){0,0===--t&&(clearInterval(g.temp_t),console.log("答案数组",o.linegroup,e),o.check_answer()?o.submitScore(100,1):o.submitScore(0,4))},1e3)}})}(window,game),function(t,d){d.state.add("05",function(){var a=this;this.buttonId=null;var r=!0,i=new Array,o=!1;this.init=function(t){d.scale.pageAlignHorizontally=!0,d.scale.pageAlignVertically=!0,d.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,d.stage.setBackgroundColor(16777215),this.data=t,this.fensu=0,this.wrong=!1,i=new Array,r=!0,10,i=new Array,0,o=!1,this.body_group=null,this.game_but=null},this.preload=function(){},this.create=function(){var t=this.data.other_images;if(t)for(var e=0;e<t.length;e++)""!==t[e].image&&d.add.image(t[e].pos.x,t[e].pos.y,d.stateIndex+"other_images"+e+"temp");var a=this,i=d.add.text(this.data.text_pos.x,this.data.text_pos.y,this.data.title,{fill:this.data.fontColor,fontSize:this.data.fontSize,align:"center"});if(i.setTextBounds(0,0,250,40),i.wordWrapWidth=900,i.wordWrap=!0,""!=this.data.q_image&&null!=this.data.q_image&&""!=this.data.pos&&null!=this.data.pos&&d.add.image(this.data.pos.x,this.data.pos.y,d.stateIndex+"questionImage"),""!=this.data.image&&null!=this.data.image)d.add.image(this.data.text_pos.x,this.data.text_pos.y,d.stateIndex+"titleImage");a.body_group=d.add.group();for(var s=0;s<this.data.body.length;s++){""!=this.data.body[s].pos?a.body_group.add(d.add.button(this.data.body[s].pos.x,this.data.body[s].pos.y,d.stateIndex+"body_image"+s,a.onClick,this)):a.body_group.add(d.add.button(200+200*s,400,d.stateIndex+"body_image"+s,a.onClick,this));var n=a.body_group.children[s];n.id=s,n.have_image=null,n.isFlag=!1,n.alpha=.5}if(gameManager.is_teacher||(""!=this.data.ok_btnPos&&null!=this.data.ok_btnPos?a.queren=d.add.button(this.data.ok_btnPos.x,this.data.ok_btnPos.y,"OK",a.check_answer,this,1,0,1,0):a.queren=d.add.button(450,620,"OK",a.check_answer,this,1,0,1,0)),d.is_teacher){var o=d.add.image(60,550,"go");this.game_but=d.add.text(5,10,"GO",{fill:"#000000",fontSize:60,fontWeight:"normal",boundsAlignH:"center",boundsAlignV:"middle"}),this.game_but.setTextBounds(35,38,32,30),o.addChild(this.game_but),this.game_but.inputEnabled=!0;a=this;this.game_but.events.onInputUp.add(function(){if(!r)return!1;if(r){r=!1;var t=9,e=setInterval(function(){if(0===--t)return a.game_but.text="END",a.game_but.fontSize=40,16119285,a.game_but.style.color=13434880,clearInterval(e),r=!0,!1;a.game_but.text=t+"s"},1e3)}gameManager.startTesting()})}else d.show_mengban(),d.progressBar=this.add_progress_bar(0,0,758),d.progressBar.alpha=0;gameCommon()};this.add_progress_bar=function(t,e,a){var i=d.add.graphics(0,0);i.beginFill(4443520),i.drawRect(0,0,d.width,10),i.endFill();var s=d.add.sprite(e,a,i.generateTexture());return i.destroy(),s};this.onClick=function(a){if(d.is_teacher)return!1;if(o)return console.log("已经提交无法重复选择"),!1;if(null!=a.have_image){if(a.have_image=null,a.isFlag=!1,console.log("1",a.isFlag),a.id+1>i.length)console.log("取消选择==2=",1),i.splice(i.length-1,1);else{console.log("取消选择==3=",a.id);for(var t=0;t<i.length;t++)i[t]==a.id&&i.splice(t,1)}return a.children[0].destroy(),void console.log("取消选择===",i)}null==a.have_image&&(console.log("2",a.isFlag),a.isFlag=!0,a.have_image=a.id,i.push(a.have_image),d.add.tween(a).to({width:a.width+20,height:a.height+20},100,null,!0,0,1,!0),setTimeout(function(){var t=d.add.graphics(0,0),e="0xA2FCFA";0==a.id?e="0xF5E843":1==a.id?e="0xec003a":2==a.id&&(e="0xA2FCFA"),t.lineStyle(10,e),t.drawRoundedRect(a.x,a.y,a.width-20,a.height-20);a.addChild(d.add.image(0,0,t.generateTexture()));t.destroy()},100),console.log("选中的答案",i))},this.check_answer=function(t){if(d.is_teacher)return!1;if(o)return console.log("已经提交不能重复提交"),!1;if(a.data.answer.length==i.length){for(k in i){var e=i[k];if(!a.check_sub(e)){for(s in a.fensu=0,a.wrong=!0,console.log("哪些选错了",e),a.data.body)a.check_sub(s)?""!=this.data.body[s].pos?d.add.image(this.data.body[s].pos.x+20,this.data.body[s].pos.y+25,"choice",1):d.add.image(510,115,"choice",2):""!=this.data.body[s].pos?d.add.image(this.data.body[s].pos.x+20,this.data.body[s].pos.y+25,"choice",2):d.add.image(510,115,"choice",2);return clearInterval(d.temp_t),a.submitScore(a.fensu,4),console.log("答错了"),clearInterval(d.temp_t),!1}}for(l in a.data.body)a.check_sub(l)?""!=this.data.body[l].pos?d.add.image(this.data.body[l].pos.x+20,this.data.body[l].pos.y+25,"choice",1):d.add.image(510,115,"choice",2):""!=this.data.body[l].pos?d.add.image(this.data.body[l].pos.x+20,this.data.body[l].pos.y+25,"choice",2):d.add.image(510,115,"choice",2);clearInterval(d.temp_t),a.fensu=100,console.log("答对啦"),clearInterval(d.temp_t),a.submitScore(a.fensu,1)}else{for(s in a.fensu=0,a.wrong=!0,a.data.body)a.check_sub(s)?""!=this.data.body[s].pos?d.add.image(this.data.body[s].pos.x+20,this.data.body[s].pos.y+25,"choice",1):d.add.image(510,115,"choice",2):""!=this.data.body[s].pos?d.add.image(this.data.body[s].pos.x+20,this.data.body[s].pos.y+25,"choice",2):d.add.image(510,115,"choice",2);clearInterval(d.temp_t),a.submitScore(a.fensu,4),console.log("答错了")}a.queren.frame=1,o=!0},this.check_sub=function(t){for(n in a.data.answer){if(a.data.answer[n]==t)return!0}return!1},this.submitScore=function(t,e){if(a.wrong&&(e=4),gameManager.stars(Math.round(t)),clearInterval(d.temp_t),1==e)return log("多选提交分数正确"),log(t),void ScoreAnimtions(t);4==e&&(log("多选错误====="),gameErrorAnimations())},this.answers_startgame=function(){if(d.is_teacher&&null!=this.game_but){var t=this;if(!r)return!1;if("END"!=t.game_but.text&&r){r=!1;var e=9,a=setInterval(function(){if(0===--e)return t.game_but.text="END",t.game_but.fontSize=40,16119285,t.game_but.style.color=13434880,clearInterval(a),r=!0,!1;t.game_but.text=e+"s"},1e3)}"END"!=t.game_but.text&&gameManager.startTesting()}},this.startgame=function(e){null==e&&(e=9);for(var t=0;t<this.body_group.length;t++){this.body_group.children[t].alpha=1}d.progressBar.alpha=1,d.show_mengban(!0);d.add.tween(d.progressBar).to({width:0,alpha:0},8e3,Phaser.Easing.Linear.None,!0).onComplete.add(function(){o=!0}),d.temp_t=setInterval(function(){if(0,0===--e)for(var t in!1,o=!0,clearInterval(d.temp_t),a.submitScore(0,3),a.data.body)a.check_sub(t)?""!=this.data.body[t].pos?d.add.image(this.data.body[t].pos.x+20,this.data.body[t].pos.y+25,"choice",1):d.add.image(510,115,"choice",2):(console.log(t),""!=this.data.body[t].pos?d.add.image(this.data.body[t].pos.x+20,this.data.body[t].pos.y+25,"choice",2):d.add.image(510,115,"choice",2))},1e3),console.log("该题开始答题")}})}(window,game),function(t,a){a.state.add("201",{init:function(){a.scale.pageAlignHorizontally=!0,a.scale.pageAlignVertically=!0,a.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL;var t=a.data,e=a.stateIndex;this.data=t[e]},create:function(){a.is_teacher&&(gameManager.startTesting(),function t(e,a,i){if(a&&0<a.length){var s=a.shift();if(s){for(var n=0;n<s.length;n++)s[n].index=n;!function t(e,a,i,s,n,o,r){var d=setTimeout(function(){item=e.shift(),item&&(0===item.index?i.moveTo(l(item.x,100,2.5),l(item.y,0,2.5)):i.lineTo(l(item.x,100,2.5),l(item.y,0,2.5))),0<e.length?t(e,a,i,s,n,o,r):s&&s(r,n,o)},1e3*a);o.stateIndex!==r.page&&clearTimeout(d)}(s,.001,o(16711935),t,a,i,e)}}}(this.data,JSON.parse(JSON.stringify(this.data.data.Pdata)),a)),gameCommon();var t=this.data.data.other_images;if(t)for(var e=0;e<t.length;e++)""!==t[e].image&&a.add.image(t[e].pos.x,t[e].pos.y,a.stateIndex+"other_images"+e+"temp");function o(t){var e=a.add.graphics(0,0);return e.lineStyle(20,t,1),e}function l(t,e,a){return(t+e)*a}function s(t){t.input.touch.touchStartCallback=null,t.input.touch.touchMoveCallback=null,t.input.touch.touchEndCallback=null}this.arr=[],function(a,t){this.flag=!0,this.arr=t;var i=this;a.input.touch.touchStartCallback=function(t){"newdraw"!==a.data[a.stateIndex].type?s(a):(i.graphics=o(16711680),i.flag=!1,i.arr.push([]))},a.input.touch.touchMoveCallback=function(t){if("newdraw"!==a.data[a.stateIndex].type)s(a);else{var e=i.arr[i.arr.length-1];i.flag?i.graphics.lineTo(a.input.activePointer.x,a.input.activePointer.y):(i.flag=!0,i.graphics.moveTo(a.input.activePointer.x,a.input.activePointer.y)),e.push({x:a.input.activePointer.x,y:a.input.activePointer.y})}},a.input.touch.touchEndCallback=function(t){"newdraw"!==a.data[a.stateIndex].type?s(a):i.graphics=null}}(a,this.arr)},shutdown:function(t){var e=newDrawGetScore(this.arr,this.data.data.Pdata).score;console.log(e),console.log(this.data.data.Pdata),console.log(this.arr),e=parseInt(e,10),e=isNaN(e)?0:e,console.log(e),gameManager.stars(Math.round(e)),ScoreAnimtions(e)}})}(window,game),function(t,o){o.state.add("09",function(){var n=this,i=!0;this.init=function(t){o.scale.pageAlignHorizontally=!0,o.scale.pageAlignVertically=!0,o.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,o.stage.setBackgroundColor(16777215),i=!0,this.dianji=!1,this.data=t,this.fensu=0,this.wrong=!1,this.buttonId=null,this.body_group=null,this.game_but=null,this.groupA=null,this.groupB=null,this.isAnswer=!1,this.TwisRunning=!1},this.preload=function(){},this.addTitle=function(){""!=this.data.title_img&&null!=this.data.title_img&&o.add.image(this.data.text_pos.x,this.data.text_pos.y,o.stateIndex+"title_img")},this.roleInit=function(){if(o.is_teacher){var t=o.add.image(60,550,"go");this.game_but=o.add.text(5,10,"GO",{fill:"#000000",fontSize:60,fontWeight:"normal",boundsAlignH:"center",boundsAlignV:"middle"}),this.game_but.setTextBounds(35,38,32,30),t.addChild(this.game_but),this.game_but.inputEnabled=!0;var a=this;this.game_but.events.onInputUp.add(function(){if(!i)return!1;if(i){i=!1;var t=9,e=setInterval(function(){if(0===--t)return a.game_but.text="END",a.game_but.fontSize=40,16119285,a.game_but.style.color=13434880,clearInterval(e),i=!0,!1;a.game_but.text=t+"s"},1e3)}gameManager.startTesting()})}else o.show_mengban(),o.progressBar=this.add_progress_bar(0,0,758),o.progressBar.alpha=0},this.addGroupA=function(){this.groupA=o.add.group(),this.groupA.enableBody=!0,this.groupA.physicsBodyType=Phaser.Physics.ARCADE;for(var t=0;t<this.data.groupA.length;t++){var e=this.data.groupA[t];null==e.pos&&""==e.pos||this.groupA.create(e.pos.x,e.pos.y,o.stateIndex+"groupA_image"+t)}for(var a in this.groupA.children)this.groupA.children[a].id=a,this.groupA.children[a].answer=this.data.groupA[a].answer},this.addGroupB=function(){this.groupB=o.add.group(),this.groupB.enableBody=!0,this.groupB.physicsBodyType=Phaser.Physics.ARCADE;for(var t=0;t<this.data.groupB.length;t++){var e=this.data.groupB[t];null==e.pos&&""==e.pos||this.groupB.create(e.pos.x,e.pos.y,o.stateIndex+"groupB_image"+t)}for(var a in this.groupB.children){this.groupB.children[a].id=a,this.groupB.children[a].answer=!1;for(var i=0;i<this.groupA.children.length;i++)this.groupA.children[i].answer==a&&(this.groupB.children[a].x=this.groupA.children[i].x,this.groupB.children[a].y=this.groupA.children[i].y,this.groupB.children[a].width=this.groupA.children[i].width,this.groupB.children[a].height=this.groupA.children[i].height)}setTimeout(function(){n.startAnswer()},1e3)},this.startAnswer=function(){var t=function(t){for(var e=[],a=0;a<t;a++){var i=(n=t+(s=1),parseInt(Math.random()*(n-s)+s));o(e,i)?a--:e.push(i)}var s,n;function o(t,e){for(var a=0;a<t.length;a++)if(t[a]==e)return!0;return!1}return e}(this.data.groupB.length);for(var e in this.groupB.children){this.groupB.children[e].id=e;var a=this.groupB.children[e],i=this.data.groupB[t[e]-1].pos.x,s=this.data.groupB[t[e]-1].pos.y;this.groupB.children[e].old={x:i,y:s},a.inputEnabled=!0,a.input.enableDrag(),a.events.onDragStop.add(this.DragStop,this),a.events.onDragStart.add(this.DragStart,this),n.TwisRunning=!0,o.add.tween(a).to({x:i,y:s},400,null,!0,0,0).onComplete.add(function(){n.TwisRunning=!1})}},this.DragStart=function(t){},this.DragStop=function(t){console.log("拖拽结束===",t.answer);var e=o.physics.arcade.overlap(t,this.groupA,this.check_over,null,this);if(!e){console.log("没发生碰撞的",e);var a=t.old.x,i=t.old.y;o.add.tween(t).to({x:a,y:i},300,null,!0,0,0).onComplete.add(function(){t.inputEnabled=!0,n.TwisRunning=!1})}},this.check_over=function(t,e){if(t.answer)console.log("已经碰撞",t.answer);else if(console.log("self.tw[1].isRunning",n.TwisRunning),t.id==this.data.groupA[e.id].answer){if(n.TwisRunning)return;n.TwisRunning=!0,o.add.tween(t).to({x:this.data.groupA[e.id].pos.x,y:this.data.groupA[e.id].pos.y},300,null,!0,0,0).onComplete.add(function(){t.answer=!0,t.inputEnabled=!1,n.TwisRunning=!1,n.judgeAnswer()&&n.submitScore(100,1)})}else{if(n.TwisRunning)return;n.TwisRunning=!0;var a=t.old.x,i=t.old.y;o.add.tween(t).to({x:a,y:i},300,null,!0,0,0).onComplete.add(function(){t.inputEnabled=!0,n.TwisRunning=!1})}},this.judgeAnswer=function(){for(var t in this.groupB.children){if(!this.groupB.children[t].answer)return!1}return!0},this.addItme=function(){if(""!=this.data.item&&null!=this.data.item)for(var t=0;t<this.data.item.length;t++)""!=this.data.item[t].image&&o.add.image(this.data.item[t].pos.x,this.data.item[t].pos.y,o.stateIndex+"item_image"+t)},this.create=function(){console.log("进入拼图==",this.data.item),this.addTitle(),this.addItme(),this.addGroupA(),this.addGroupB(),gameCommon(),this.roleInit()};this.add_progress_bar=function(t,e,a){var i=o.add.graphics(0,0);i.beginFill(4443520),i.drawRect(0,0,o.width,10),i.endFill();var s=o.add.sprite(e,a,i.generateTexture());return i.destroy(),s},this.submitScore=function(t,e){n.wrong,gameManager.stars(Math.round(t)),0!=t&&(o.progressBar&&(o.progressBar.alpha=1),ScoreAnimtions(t),console.log("星星数量==2===",gameManager.start),clearInterval(o.temp_t))},this.answers_startgame=function(){if(o.is_teacher&&null!=this.game_but){var t=this;if(!i)return!1;if("END"!=t.game_but.text&&i){i=!1;var e=9,a=setInterval(function(){if(0===--e)return t.game_but.text="END",t.game_but.fontSize=40,16119285,t.game_but.style.color=13434880,clearInterval(a),i=!0,!1;t.game_but.text=e+"s"},1e3)}"END"!=t.game_but.text&&gameManager.startTesting()}},this.startgame=function(t){null==t&&(t=7),o.progressBar.alpha=1,o.show_mengban(!0);o.add.tween(o.progressBar).to({width:0,alpha:0},8e3,Phaser.Easing.Linear.None,!0).onComplete.add(function(){n.submitScore(0,4)})}})}(window,game),function(t,d){d.state.add("04",function(){var s=this,r=!0,n=10;this.init=function(t){d.scale.pageAlignHorizontally=!0,d.scale.pageAlignVertically=!0,d.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,d.stage.setBackgroundColor(16777215),r=!0,this.dianji=!1,this.data=t,this.fensu=0,this.wrong=!1,this.buttonId=null,this.body_group=null,this.game_but=null},this.preload=function(){},this.create=function(){var t=this.data.other_images;if(t)for(var e=0;e<t.length;e++)""!==t[e].image&&d.add.image(t[e].pos.x,t[e].pos.y,d.stateIndex+"other_images"+e+"temp");var a=this;if(""!=this.data.background&&d.add.image(0,0,d.stateIndex+"background"),""!=this.data.q_image&&null!=this.data.q_image)d.add.image(this.data.pos.x,this.data.pos.y,d.stateIndex+"q_image");""!=this.data.titleImage&&null!=this.data.titleImage&&d.add.image(this.data.text_pos.x,this.data.text_pos.y,d.stateIndex+"titleImage");d.add.text(this.data.text_pos.x,this.data.text_pos.y,this.data.title,{fill:this.data.fill_color,fontSize:this.data.font_size});this.body_group=d.add.group();for(var i=0;i<this.data.body.length;i++){var s=this.data.body[i].pos.x;""!=this.data.body[i].pos?this.body_group.add(d.add.button(s,this.data.body[i].pos.y,d.stateIndex+"body_image"+i,a.onClick,this)):this.body_group.add(d.add.button(200+200*i,400,d.stateIndex+"body_image"+i,a.onClick,this));var n=this.body_group.children[i];n.id=i,gameAdmissionAnimations(this.data.animation,n,this.data.body[i].pos.x,this.data.body[i].pos.y)}if(d.is_teacher){var o=d.add.image(60,550,"go");this.game_but=d.add.text(5,10,"GO",{fill:"#000000",fontSize:60,fontWeight:"normal",boundsAlignH:"center",boundsAlignV:"middle"}),this.game_but.setTextBounds(35,38,32,30),o.addChild(this.game_but),this.game_but.inputEnabled=!0;a=this;this.game_but.events.onInputUp.add(function(){if(!r)return!1;if(r){r=!1;var t=9,e=setInterval(function(){if(0===--t)return a.game_but.text="END",a.game_but.fontSize=40,16119285,a.game_but.style.color=13434880,clearInterval(e),r=!0,!1;a.game_but.text=t+"s"},1e3)}gameManager.startTesting()})}else d.show_mengban(),d.progressBar=this.add_progress_bar(0,0,758),d.progressBar.alpha=0;gameCommon()};this.add_progress_bar=function(t,e,a){var i=d.add.graphics(0,0);i.beginFill(4443520),i.drawRect(0,0,d.width,10),i.endFill();var s=d.add.sprite(e,a,i.generateTexture());return i.destroy(),s},this.onClick=function(t){if(!gameManager.is_teacher&&!this.dianji){if(!this.dianji){var e=t.id;if(s.buttonId=t.id,t.id==s.data.answer){""!=this.data.body[e].pos?d.add.image(this.data.body[e].pos.x,this.data.body[e].pos.y+30,"choice",1):d.add.image(510,115,"choice",1);for(var a=0;a<s.body_group.length;a++){var i=a;a!==t.id&&(d.add.image(this.data.body[i].pos.x,this.data.body[i].pos.y+30,"choice",0),s.body_group.children[a].alpha=.5)}n<=0&&(n=0),0==s.fensu&&(s.fensu=100,this.dianji=!1)}else{""!=s.data.body[s.data.answer].pos?d.add.image(s.data.body[s.data.answer].pos.x,s.data.body[s.data.answer].pos.y+30,"choice",1):d.add.image(510,115,"choice",1),d.add.image(s.data.body[e].pos.x,s.data.body[e].pos.y+30,"choice",2);for(a=0;a<s.body_group.length;a++){i=a;a!==t.id&&a!==s.data.answer&&(d.add.image(s.data.body[i].pos.x,s.data.body[i].pos.y+30,"choice",0),s.body_group.children[a].alpha=.5)}gameErrorAnimations(),s.fensu=0,s.wrong=!0}}t.frame=1,clearInterval(d.temp_t),s.submitScore(s.fensu,1),console.log("点击了按钮",t.id),this.dianji=!0}},this.submitScore=function(t,e){s.wrong,gameManager.stars(Math.round(t)),0!=t&&(d.progressBar.alpha=1,ScoreAnimtions(t),console.log("星星数量==2===",gameManager.start),clearInterval(d.temp_t))},this.answers_startgame=function(){if(d.is_teacher&&null!=this.game_but){var t=this;if(!r)return!1;if("END"!=t.game_but.text&&r){r=!1;var e=9,a=setInterval(function(){if(0===--e)return t.game_but.text="END",t.game_but.fontSize=40,16119285,t.game_but.style.color=13434880,clearInterval(a),r=!0,!1;t.game_but.text=e+"s"},1e3)}"END"!=t.game_but.text&&gameManager.startTesting()}},this.startgame=function(a){null==a&&(a=7);for(var t=0;t<this.body_group.length;t++){this.body_group.children[t].alpha=1}d.progressBar.alpha=1,d.show_mengban(!0);d.add.tween(d.progressBar).to({width:0,alpha:0},8e3,Phaser.Easing.Linear.None,!0).onComplete.add(function(){s.dianji=!0}),d.temp_t=setInterval(function(){if(n--,0===--a){s.dianji=!0;for(var t=0;t<s.body_group.length;t++){var e=t;e==s.data.answer?d.add.image(s.data.body[e].pos.x+50,s.data.body[e].pos.y-45,"choice",1):d.add.image(s.data.body[e].pos.x+50,s.data.body[e].pos.y-45,"choice",0)}clearInterval(d.temp_t),s.submitScore(0,3)}},1e3),console.log("该题开始答题")}})}(window,game),function(t,g){g.state.add("02",function(){var n,o,r=this,d=!0,l=!1;this.volumeView=null,this.init=function(t){g.scale.pageAlignHorizontally=!0,g.scale.pageAlignVertically=!0,g.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,g.stage.setBackgroundColor(16777215),void 0===t&&(t={image:"./states/world_record_6/images/pic6.png",pos:{x:140,y:150},text:"Colors"}),d=!0,l=!1,r.volumeView=null,this.data=t,this.Score=0,this.game_but=null},this.preload=function(){},this.create=function(){var t=this.data.other_images;if(t)for(var e=0;e<t.length;e++)""!==t[e].image&&g.add.image(t[e].pos.x,t[e].pos.y,g.stateIndex+"other_images"+e+"temp");g.add.text(this.data.text_pos.x,this.data.text_pos.y,this.data.title,{fill:this.data.fill_color,fontSize:this.data.font_size});if(""!=this.data.image&&null!=this.data.image&&""!=this.data.pos)g.add.image(this.data.pos.x,this.data.pos.y,g.stateIndex+"pic");if(""!=this.data.overviewImage&&null!=this.data.overviewImage){var a=g.add.image(this.data.overviewImage_pos.x,this.data.overviewImage_pos.y,g.stateIndex+"overviewImage");null!=this.data.imageAnimation&&""!=this.data.imageAnimation&&(a.alpha=0,gameAdmissionAnimations(this.data.imageAnimation,a,this.data.overviewImage_pos.x,this.data.overviewImage_pos.y))}if(""!=this.data.text_Image&&null!=this.data.text_Image&&g.add.image(this.data.text_pos.x,this.data.text_pos.y,g.stateIndex+"text_Image"),g.is_teacher){var i=g.add.image(60,550,"go");this.game_but=g.add.text(5,10,"GO",{fill:"#000000",fontSize:60,fontWeight:"normal",boundsAlignH:"center",boundsAlignV:"middle"}),this.game_but.setTextBounds(35,38,32,30),i.addChild(this.game_but),this.game_but.inputEnabled=!0;var s=this;this.game_but.events.onInputUp.add(function(){if(!d)return!1;if(d){d=!1;var t=9,e=setInterval(function(){if(0===--t)return s.game_but.text="END",s.game_but.fontSize=40,16119285,s.game_but.style.color=13434880,clearInterval(e),d=!0,!1;s.game_but.text=t+"s"},1e3)}gameManager.startTesting()})}else g.show_mengban(),g.progressBar=this.add_progress_bar(0,0,758),g.progressBar.alpha=0;gameCommon()};this.add_progress_bar=function(t,e,a){var i=g.add.graphics(0,0);i.beginFill(4443520),i.drawRect(0,0,g.width,10),i.endFill();var s=g.add.sprite(e,a,i.generateTexture());return i.destroy(),s},this.startRecord=function(){if(g.btn)return!1;l||(l=!0,n=g.add.image(387,560,"luyin"),(o=g.add.image(377,550,"luyinz")).width=.6*o.width,o.height=.6*o.height,n.animations.add("run"),n.animations.play("run",7,!0,1),gameManager.recordsentence(r.data.text,r.recordcall))},this.waiting=function(t){null==r.waitingView&&(r.waitingView=g.add.sprite(g.width/2-150,g.height/2-150,"wait"),r.waitingView.animations.add("w")),t?g.show_mengban(!0):g.show_mengban(),t?r.waitingView.alpha=0:(r.waitingView.alpha=1,r.waitingView.animations.play("w",16,!0))},this.recordcall=function(t,e){if(console.log(r.volumeView),"volume"==t){var a=Math.round(e/30*10);l&&(r.volumeView.frame=a-1)}if("scores"==t){if(r.waiting(!0),0<r.Score)return!1;r.submitScore(e,2)}},this.addVolume=function(){return null==r.volumeView&&((void 0).alpha=0),r.volumeView},this.submitScore=function(t,e){t<=1&&(t=.5*Math.random()+1),t=Number(t),isNaN(t)&&(t=.5*Math.random()+1),n.alpha=0,o.alpha=0,l=!1,r.Score=Math.round(20*t),gameManager.stars(r.Score),ScoreAnimtions(r.Score),n.alpha=0,o.alpha=0,g.progressBar.alpha=1},this.answers_startgame=function(){if(g.is_teacher&&null!=this.game_but){var t=this;if(!d)return!1;if("END"!=t.game_but.text&&d){d=!1;var e=9,a=setInterval(function(){if(0===--e)return t.game_but.text="END",t.game_but.fontSize=40,16119285,t.game_but.style.color=13434880,clearInterval(a),d=!0,!1;t.game_but.text=e+"s"},1e3)}"END"!=t.game_but.text&&gameManager.startTesting()}},this.startgame=function(){g.progressBar.alpha=1,g.show_mengban(!0);g.add.tween(g.progressBar).to({width:0,alpha:0},8e3,Phaser.Easing.Linear.None,!0).onComplete.add(function(){if(n.alpha=0,o.alpha=0,l=!1,0==r.Score){var t=(e=70,a=100,i=Math.random()*(a-e),s=Math.round(i+e),s=Math.max(Math.min(s,a),e));gameManager.stars(t),ScoreAnimtions(r.Score=t)}var e,a,i,s;n.alpha=0,o.alpha=0}),r.startRecord(),l=!0},this.stopgame=function(t){(void 0).alpha=1,n.alpha=0,o.alpha=0}}),this.shutdown=function(){self.submitScore(0,3),gameManager.log("清理定时器")}}(window,game),function(t,r){r.state.add("111",function(){var i=this,s=!0,n=!1,e=this.volumeView=null,a=null,o=null;this.init=function(t){r.scale.pageAlignHorizontally=!0,r.scale.pageAlignVertically=!0,r.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,r.stage.setBackgroundColor(16777215),void 0===t&&(t={image:"./states/world_record_6/images/pic6.png",pos:{x:140,y:150},text:"Colors"}),s=!0,n=!1,i.volumeView=null,this.data=t,this.Score=0,o=a=e=null,this.game_but=null},this.preload=function(){},this.create=function(){var a=this;r.add.text(this.data.text_pos.x,this.data.text_pos.y,this.data.title,{fill:this.data.fill_color,fontSize:this.data.font_size});""!=this.data.image&&null!=this.data.image&&(""!=this.data.pos?r.add.image(this.data.pos.x,this.data.pos.y,r.stateIndex+"pic").width:r.add.image(180,140,r.stateIndex+"pic"));if(""!=this.data.overviewImage&&null!=this.data.overviewImage&&r.add.image(this.data.overviewImage_pos.x,this.data.overviewImage_pos.y,r.stateIndex+"overviewImage"),r.is_teacher){var t=r.add.image(60,550,"go");this.game_but=r.add.text(5,10,"GO",{fill:"#000000",fontSize:60,fontWeight:"normal",boundsAlignH:"center",boundsAlignV:"middle"}),this.game_but.setTextBounds(35,38,32,30),t.addChild(this.game_but),this.game_but.inputEnabled=!0;a=this;this.game_but.events.onInputUp.add(function(){if(!s)return!1;if(s){s=!1;var t=9,e=setInterval(function(){if(0===--t)return a.game_but.text="END",a.game_but.fontSize=40,16119285,a.game_but.style.color=13434880,clearInterval(e),s=!0,!1;a.game_but.text=t+"s"},1e3)}gameManager.startTesting()})}else r.show_mengban(),r.progressBar=this.add_progress_bar(0,0,758),r.progressBar.alpha=0;gameCommon()};this.add_progress_bar=function(t,e,a){var i=r.add.graphics(0,0);i.beginFill(4443520),i.drawRect(0,0,r.width,10),i.endFill();var s=r.add.sprite(e,a,i.generateTexture());return i.destroy(),s},this.startRecord=function(){n||(n=!0,a=r.add.image(440,560,"luyin"),(o=r.add.image(430,550,"luyinz")).width=.6*o.width,o.height=.6*o.height,a.animations.add("run"),a.animations.play("run",7,!0,1),setTimeout(function(){null!=a&&(a.alpha=0),null!=o&&(o.alpha=0),i.Score=Math.round(100),gameManager.stars(i.Score),ScoreAnimtions(i.Score),n=!1},6e3))},this.waiting=function(t){null==i.waitingView&&(i.waitingView=r.add.sprite(r.width/2-150,r.height/2-150,"wait"),i.waitingView.animations.add("w")),t?r.show_mengban(!0):r.show_mengban(),t?i.waitingView.alpha=0:(i.waitingView.alpha=1,i.waitingView.animations.play("w",16,!0))},this.recordcall=function(t,e){if(console.log(i.volumeView),"volume"==t){var a=Math.round(e/30*10);n&&(i.volumeView.frame=a-1)}"scores"==t&&(i.waiting(!0),i.submitScore(e,2))},this.addVolume=function(){return null==i.volumeView&&(e.alpha=0),i.volumeView},this.submitScore=function(t,e){t<=1&&(t=.5*Math.random()+1),t=Number(t),isNaN(t)&&(t=.5*Math.random()+1),a.alpha=0,o.alpha=0,n=!1,i.Score=Math.round(20*t),gameManager.stars(i.Score),gameManager.addRecord(i.Score),ScoreAnimtions(i.Score),a.alpha=0,o.alpha=0,r.progressBar.alpha=1},this.answers_startgame=function(){if(r.is_teacher&&null!=this.game_but){var t=this;if(!s)return!1;if("END"!=t.game_but.text&&s){s=!1;var e=9,a=setInterval(function(){if(0===--e)return t.game_but.text="END",t.game_but.fontSize=40,16119285,t.game_but.style.color=13434880,clearInterval(a),s=!0,!1;t.game_but.text=e+"s"},1e3)}"END"!=t.game_but.text&&gameManager.startTesting()}},this.startgame=function(){r.progressBar.alpha=1,r.show_mengban(!0),i.startRecord(),n=!0;r.add.tween(r.progressBar).to({width:0,alpha:0},8e3,Phaser.Easing.Linear.None,!0).onComplete.add(function(){})},this.stopgame=function(t){e.alpha=1,a.alpha=0,o.alpha=0}}),this.shutdown=function(){self.submitScore(0,3),gameManager.log("清理定时器")}}(window,game),function(t,r){var a=this,d=!0,n=!1;r.state.add("07",function(){this.feeling_tween=[],this.mood=[];this.init=function(t){r.scale.pageAlignHorizontally=!0,r.scale.pageAlignVertically=!0,r.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,r.physics.startSystem(Phaser.Physics.ARCADE),this.data=t,n=!1,void 0===t&&(this.data={title:"heheheh",num:[999,66,45]}),this.groupA=null,this.score=0,(a=this).feeling_texts=[],this.game_but=null},this.preload=function(){},this.getItemVote=function(t){for(name in t)for(var e=0;e<this.data.body.length;e++)this.data.body[e].name==name&&(""==t[name]&&(t[name]=0),this.feeling_texts[e].text=t[name],console.log("显示人数====="),this.feeling_texts[e].alpha=1)},this.create=function(){var t=this.data.other_images;if(t)for(var e=0;e<t.length;e++)""!==t[e].image&&r.add.image(t[e].pos.x,t[e].pos.y,r.stateIndex+"other_images"+e+"temp");var a=this;""!=this.data.overviewImage&&r.add.image(this.data.pos.x,this.data.pos.y,r.stateIndex+"overviewImage"),""!=this.data.titleImage&&null!=this.data.titleImage&&r.add.image(this.data.text_pos.x,this.data.text_pos.y,r.stateIndex+"titleImage");var i=r.add.text(this.data.text_pos.x,this.data.text_pos.y,this.data.title,{fill:this.data.fill_color,fontSize:this.data.font_size,align:"center",boundsAlignH:"center"});i.setTextBounds(10,0,700,40),i.wordWrapWidth=900,i.wordWrap=!0,this.groupA=r.add.group();for(var s=0;s<this.data.body.length;s++){this.groupA.add(r.add.button(this.data.body[s].pos.x,this.data.body[s].pos.y,r.stateIndex+"body_image"+s,this.onClick,this));var n=this.groupA.children[s];n.id=s,n.name=this.data.body[s].name,n.alpha=.5}for(s=0;s<this.data.body.length;s++){this.data.body[s].pos.x,this.groupA.children[s].width;this.feeling_texts[s]=r.add.text(this.data.body[s].pos.x,this.data.body[s].pos.y,this.data.body[s].nameNum,{fill:"#407eff",fontSize:28,align:"center",boundsAlignH:"center"}),this.feeling_texts[s].setTextBounds(0,0,this.groupA.children[s].width,40),gameManager.is_teacher?this.feeling_texts[s].alpha=1:this.feeling_texts[s].alpha=0}if(r.is_teacher){var o=r.add.image(60,550,"go");this.game_but=r.add.text(5,10,"GO",{fill:"#000000",fontSize:60,fontWeight:"normal",boundsAlignH:"center",boundsAlignV:"middle"}),this.game_but.setTextBounds(35,38,32,30),o.addChild(this.game_but),this.game_but.inputEnabled=!0;a=this;this.game_but.events.onInputUp.add(function(){if(!d)return!1;if(d){d=!1;var t=9,e=setInterval(function(){if(0===--t)return a.game_but.text="END",a.game_but.fontSize=40,16119285,a.game_but.style.color=13434880,clearInterval(e),d=!0,!1;a.game_but.text=t+"s"},1e3)}gameManager.startTesting()})}else r.show_mengban(),r.progressBar=this.add_progress_bar(0,0,758),r.progressBar.alpha=0;gameCommon()},this.onClick=function(t){r.is_teacher||n||(r.add.tween(t).to({width:t.width+20,height:t.height+20},100,null,!0,0,1,!0),gameManager.postVote(t.name),this.score=100,this.submitScore(100,-1),n=!0)};this.add_progress_bar=function(t,e,a){var i=r.add.graphics(0,0);i.beginFill(4443520),i.drawRect(0,0,r.width,10),i.endFill();var s=r.add.sprite(e,a,i.generateTexture());return i.destroy(),s},this.submitScore=function(t,e){a.wrong,gameManager.stars(Math.round(t)),ScoreAnimtions(t),console.log("星星数量==互动题===",gameManager.start),clearInterval(r.temp_t)},this.answers_startgame=function(){if(r.is_teacher&&null!=this.game_but){var t=this;if(!d)return!1;if("END"!=t.game_but.text&&d){d=!1;var e=9,a=setInterval(function(){if(0===--e)return t.game_but.text="END",t.game_but.fontSize=40,16119285,t.game_but.style.color=13434880,clearInterval(a),d=!0,!1;t.game_but.text=e+"s"},1e3)}"END"!=t.game_but.text&&gameManager.startTesting()}},this.startgame=function(t){null==t&&(t=7);var s=this;if(!gameManager.is_teacher){for(var e=0;e<this.groupA.length;e++){this.groupA.children[e].alpha=1}r.progressBar.alpha=1,r.show_mengban(!0);r.add.tween(r.progressBar).to({width:0,alpha:0},8e3,Phaser.Easing.Linear.None,!0).onComplete.add(function(){var t=json_data.courseware[gameManager.tid];if(t){for(var e=t.data.body,a=new Array,i=0;i<e.length;i++)a.push(e[i].name);n=!0,gameManager.getVote(a),0==s.score&&gameManager.sendScore(s.score,100,-1)}}),r.temp_t=setInterval(function(){0,0===--t&&(!1,n=!0,clearInterval(r.temp_t),s.submitScore(s.score,3))},1e3),null!=this.data.voice&&""!=this.data.voice&&r.sound.play("voice")}},this.stopgame=function(t){r.is_teacher}})}(window,game);
//# sourceMappingURL=app.js.map
